System.register(["./json-asset-1f2be75e.js","./index-a996f499.js","./view-368b93a3.js","./deprecated-c0e66301.js","./camera-component-4c08f67b.js","./renderable-component-da5e0106.js","./transform-utils-ca30a5c5.js","./sprite-frame-9016d268.js","./renderable-2d-549948c8.js","./vertex-format-eb40922d.js","./deprecated-4eee0a13.js","./ZipUtils-3ae2be0b.js"],(function(t){"use strict";var e,r,i,a,n,o,s,l,h,p,c,u,d,f,m,y,g,b,_,v,S,C,w,F,P,T,D,A,R,V,x,O,I,E,z,M,U,k,L,N,B,j;return{setters:[function(t){e=t.cJ,r=t.c3,i=t.eb,a=t.cj,n=t.gy,o=t.gE,s=t.gS,l=t.gT,h=t.ee,p=t.ef,c=t.l,u=t.eg,d=t.ec,f=t.de,m=t.eh,y=t.et,g=t.dy,b=t.c,_=t.ej,v=t.gu,S=t.gU,C=t.fX,w=t.f,F=t.e,P=t.p,T=t.d,D=t.dl,A=t.V,R=t.e1,V=t.fZ,x=t.fT,O=t.gn,I=t.dm,E=t.fY},function(t){z=t.e},function(){},function(){},function(){},function(){},function(){},function(t){M=t.S},function(t){U=t.R,k=t.M},function(t){L=t.b,N=t.c},function(){},function(t){B=t._,j=t.c}],execute:function(){var G,W,Y,H,q=e({GRAVITY:0,RADIUS:1}),X=e({FREE:0,RELATIVE:1,GROUPED:2}),Z=new r(0,0),J=new r,K=new r,Q=new r,$=new r,tt=L(N),et=function(){this.pos=new r(0,0),this.startPos=new r(0,0),this.color=new a(0,0,0,255),this.deltaColor={r:0,g:0,b:0,a:255},this.size=0,this.deltaSize=0,this.rotation=0,this.deltaRotation=0,this.timeToLive=0,this.drawPos=new r(0,0),this.aspectRatio=1,this.dir=new r(0,0),this.radialAccel=0,this.tangentialAccel=0,this.angle=0,this.degreesPerSecond=0,this.radius=0,this.deltaRadius=0},rt=new(function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e.prototype.get=function(){return this._get()||new et},e}(n))((function(t){t.pos.set(Z),t.startPos.set(Z),t.color._val=4278190080,t.deltaColor.r=t.deltaColor.g=t.deltaColor.b=0,t.deltaColor.a=255,t.size=0,t.deltaSize=0,t.rotation=0,t.deltaRotation=0,t.timeToLive=0,t.drawPos.set(Z),t.aspectRatio=1,t.dir.set(Z),t.radialAccel=0,t.tangentialAccel=0,t.angle=0,t.degreesPerSecond=0,t.radius=0,t.deltaRadius=0}),1024),it=function(){function t(t){this.particles=[],this.active=!1,this.uvFilled=0,this.finished=!1,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this._worldRotation=0,this.sys=t,this.particles=[],this.active=!1,this.readyToPlay=!0,this.finished=!1,this.elapsed=0,this.emitCounter=0,this.uvFilled=0,this._worldRotation=0}var e=t.prototype;return e.stop=function(){this.active=!1,this.readyToPlay=!1,this.elapsed=this.sys.duration,this.emitCounter=0},e.reset=function(){this.active=!0,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this.finished=!1;for(var t=this.particles,e=0;e<t.length;++e)rt.put(t[e]);t.length=0},e.emitParticle=function(t){var e=this.sys,r=rt.get();this.particles.push(r),r.timeToLive=e.life+e.lifeVar*(Math.random()-.5)*2;var i=r.timeToLive=Math.max(0,r.timeToLive);r.pos.x=e.sourcePos.x+e.posVar.x*(Math.random()-.5)*2,r.pos.y=e.sourcePos.y+e.posVar.y*(Math.random()-.5)*2;var a,n,h,p,c=e.startColor,u=e.startColorVar,d=e.endColor,f=e.endColorVar;r.color.r=a=o(c.r+u.r*(Math.random()-.5)*2,0,255),r.color.g=n=o(c.g+u.g*(Math.random()-.5)*2,0,255),r.color.b=h=o(c.b+u.b*(Math.random()-.5)*2,0,255),r.color.a=p=o(c.a+u.a*(Math.random()-.5)*2,0,255),r.deltaColor.r=(o(d.r+f.r*(Math.random()-.5)*2,0,255)-a)/i,r.deltaColor.g=(o(d.g+f.g*(Math.random()-.5)*2,0,255)-n)/i,r.deltaColor.b=(o(d.b+f.b*(Math.random()-.5)*2,0,255)-h)/i,r.deltaColor.a=(o(d.a+f.a*(Math.random()-.5)*2,0,255)-p)/i;var m=e.startSize+e.startSizeVar*(Math.random()-.5)*2;if(m=Math.max(0,m),r.size=m,-1===e.endSize)r.deltaSize=0;else{var y=e.endSize+e.endSizeVar*(Math.random()-.5)*2;y=Math.max(0,y),r.deltaSize=(y-m)/i}var g=e.startSpin+e.startSpinVar*(Math.random()-.5)*2,b=e.endSpin+e.endSpinVar*(Math.random()-.5)*2;r.rotation=g,r.deltaRotation=(b-g)/i,r.startPos.x=t.x,r.startPos.y=t.y,r.aspectRatio=e.aspectRatio||1;var _=s(e.angle+this._worldRotation+e.angleVar*(Math.random()-.5)*2);if(e.emitterMode===q.GRAVITY){var v=e.speed+e.speedVar*(Math.random()-.5)*2;r.dir.x=Math.cos(_),r.dir.y=Math.sin(_),r.dir.multiplyScalar(v),r.radialAccel=e.radialAccel+e.radialAccelVar*(Math.random()-.5)*2,r.tangentialAccel=e.tangentialAccel+e.tangentialAccelVar*(Math.random()-.5)*2,e.rotationIsDir&&(r.rotation=-l(Math.atan2(r.dir.y,r.dir.x)))}else{var S=e.startRadius+e.startRadiusVar*(Math.random()-.5)*2,C=e.endRadius+e.endRadiusVar*(Math.random()-.5)*2;r.radius=S,r.deltaRadius=-1===e.endRadius?0:(C-S)/i,r.angle=_,r.degreesPerSecond=s(e.rotatePerS+e.rotatePerSVar*(Math.random()-.5)*2)}},e.updateUVs=function(t){var e=this.renderData;if(e&&this.sys._renderSpriteFrame){for(var r=e.vData,i=this.sys._renderSpriteFrame.uv,a=t?0:this.uvFilled,n=this.particles.length,o=a;o<n;o++){var s=o*tt*4;r[s+3]=i[0],r[s+4]=i[1],r[s+12]=i[2],r[s+13]=i[3],r[s+21]=i[4],r[s+22]=i[5],r[s+30]=i[6],r[s+31]=i[7]}this.uvFilled=n}},e.updateParticleBuffer=function(t,e,r,i){var n=r.vData,o=e.x,l=e.y,h=t.size,p=h,c=t.aspectRatio;c>1?p=h/c:h=p*c;var u=h/2,d=p/2;if(t.rotation){var f=-u,m=-d,y=u,g=d,b=-s(t.rotation),_=Math.cos(b),v=Math.sin(b);n[i]=f*_-m*v+o,n[i+1]=f*v+m*_+l,n[i+2]=0,n[i+9]=y*_-m*v+o,n[i+10]=y*v+m*_+l,n[i+11]=0,n[i+18]=f*_-g*v+o,n[i+19]=f*v+g*_+l,n[i+20]=0,n[i+27]=y*_-g*v+o,n[i+28]=y*v+g*_+l,n[i+29]=0}else n[i]=o-u,n[i+1]=l-d,n[i+2]=0,n[i+9]=o+u,n[i+10]=l-d,n[i+11]=0,n[i+18]=o-u,n[i+19]=l+d,n[i+20]=0,n[i+27]=o+u,n[i+28]=l+d,n[i+29]=0;a.toArray(n,t.color,i+5),a.toArray(n,t.color,i+14),a.toArray(n,t.color,i+23),a.toArray(n,t.color,i+32)},e.step=function(t){var e=this.sys.assembler,r=this.sys,i=r.node,a=this.particles;if(t=t>e.maxParticleDeltaTime?e.maxParticleDeltaTime:t,i.updateWorldTransform(),r.positionType===X.FREE){this._worldRotation=function(t){for(var e=0,r=t;r;)e+=r.eulerAngles.z,r=r.parent;return e}(i);var n=i.worldMatrix;J.x=n.m12,J.y=n.m13}else r.positionType===X.RELATIVE?(this._worldRotation=i.eulerAngles.z,J.x=i.position.x,J.y=i.position.y):this._worldRotation=0;if(this.active&&r.emissionRate){var o=1/r.emissionRate;for(a.length<r.totalParticles&&(this.emitCounter+=t);a.length<r.totalParticles&&this.emitCounter>o;)this.emitParticle(J),this.emitCounter-=o;this.elapsed+=t,-1!==r.duration&&r.duration<this.elapsed&&r.stopSystem()}var s=this.renderData,l=a.length;s.reset(),this.requestData(4*l,6*l),l>this.uvFilled&&this.updateUVs();for(var h=0;h<a.length;){K.x=K.y=Q.x=Q.y=$.x=$.y=0;var p=a[h];if(p.timeToLive-=t,p.timeToLive>0){if(r.emitterMode===q.GRAVITY){var c=$,u=K,d=Q;(p.pos.x||p.pos.y)&&(u.set(p.pos),u.normalize()),d.set(u),u.multiplyScalar(p.radialAccel);var f=d.x;d.x=-d.y,d.y=f,d.multiplyScalar(p.tangentialAccel),c.set(u),c.add(d),c.add(r.gravity),c.multiplyScalar(t),p.dir.add(c),c.set(p.dir),c.multiplyScalar(t),p.pos.add(c)}else p.angle+=p.degreesPerSecond*t,p.radius+=p.deltaRadius*t,p.pos.x=-Math.cos(p.angle)*p.radius,p.pos.y=-Math.sin(p.angle)*p.radius;p.color.r+=p.deltaColor.r*t,p.color.g+=p.deltaColor.g*t,p.color.b+=p.deltaColor.b*t,p.color.a+=p.deltaColor.a*t,p.size+=p.deltaSize*t,p.size<0&&(p.size=0),p.rotation+=p.deltaRotation*t;var m=K;m.set(p.pos),r.positionType!==X.GROUPED&&m.add(p.startPos);var y=tt*h*4;this.updateParticleBuffer(p,m,s,y),++h}else{var g=a[h];h!==a.length-1&&(a[h]=a[a.length-1]),rt.put(g),a.length--,s.indicesCount-=6,s.vertexCount-=4}}0!==a.length||this.active||this.readyToPlay||(this.finished=!0,r._finishedSimulation())},e.requestData=function(t,e){var r=this.renderData.indicesCount;this.renderData.request(t,e);for(var i=this.renderData.indicesCount/6,a=this.renderData.iData,n=r;n<i;n++){var o=4*n;a[r++]=o,a[r++]=o+1,a[r++]=o+2,a[r++]=o+1,a[r++]=o+3,a[r++]=o+2}},t}(),at=t("ParticleAsset",h("cc.ParticleAsset")((H=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,u(e,"spriteFrame",Y,d(e)),e}return i(e,t),e}(f),Y=p((W=H).prototype,"spriteFrame",[m,y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=W))||G);c.ParticleAsset=at;var nt,ot,st,lt,ht,pt,ct,ut,dt,ft,mt,yt,gt,bt,_t,vt,St,Ct,wt,Ft,Pt,Tt,Dt,At,Rt,Vt,xt,Ot,It,Et,zt,Mt,Ut,kt,Lt,Nt,Bt,jt,Gt,Wt,Yt,Ht,qt,Xt,Zt,Jt,Kt,Qt,$t,te,ee,re,ie,ae,ne,oe,se,le,he,pe,ce,ue,de,fe,me,ye,ge,be,_e,ve,Se,Ce,we,Fe,Pe,Te,De,Ae,Re,Ve,xe,Oe,Ie,Ee,ze,Me,Ue,ke,Le,Ne,Be,je,Ge,We,Ye,He,qe,Xe,Ze=function(){function t(t){var e,r=this;this.pos=8,this.palette=[],this.imgData=[],this.text={},this.width=0,this.height=0,this.bits=0,this.colorType=0,this.compressionMethod=0,this.filterMethod=0,this.interlaceMethod=0,this.colors=0,this.hasAlphaChannel=!1,this.pixelBitlength=0,this.data=t,this.transparency={indexed:[],rgb:0,grayscale:0};for(var i=0,a=0,n=0;;){n=this.readUInt32();var o=function(){var t=[];for(i=0;i<4;++i)t.push(String.fromCharCode(r.data[r.pos++]));return t}.call(this).join("");switch(o){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(n);break;case"fcTL":e&&this.animation.frames.push(e),this.pos+=4,e={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};var s=this.readUInt16(),l=this.readUInt16()||100;e.delay=1e3*s/l,e.disposeOp=this.data[this.pos++],e.blendOp=this.data[this.pos++],e.data=[];break;case"IDAT":case"fdAT":for("fdAT"===o&&(this.pos+=4,n-=4),t=(null!=e?e.data:void 0)||this.imgData,i=0;n>=0?i<n:i>n;n>=0?++i:--i)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:this.transparency.indexed=this.read(n);var h=255-this.transparency.indexed.length;if(h>0)for(a=0;h>=0?a<h:a>h;h>=0?++a:--a)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(n)[0];break;case 2:this.transparency.rgb=this.read(n)}break;case"tEXt":var p=this.read(n),c=p.indexOf(0),u=String.fromCharCode.apply(String,p.slice(0,c));this.text[u]=String.fromCharCode.apply(String,p.slice(c+1));break;case"IEND":e&&this.animation.frames.push(e),this.colors=function(){switch(r.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this);var d=this.colorType;this.hasAlphaChannel=4===d||6===d;var f=this.colors+(this.hasAlphaChannel?1:0);return this.pixelBitlength=this.bits*f,this.colorSpace=function(){switch(r.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData instanceof Uint8Array||(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=n}if(this.pos+=4,this.pos>this.data.length)throw new Error(g(6017))}}var e=t.prototype;return e.read=function(t){var e=0,r=[];for(e=0;t>=0?e<t:e>t;t>=0?++e:--e)r.push(this.data[this.pos++]);return r},e.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},e.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},e.decodePixels=function(t){if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);t=new B.Inflate(t,{index:0,verify:!1}).decompress();for(var e=this.pixelBitlength/8,r=e*this.width,i=new Uint8Array(r*this.height),a=t.length,n=0,o=0,s=0,l=0,h=0,p=0,c=0,u=0,d=0,f=0,m=0,y=0,b=0,_=0,v=0,S=0,C=0,w=0,F=0;o<a;){switch(t[o++]){case 0:for(p=c=0;c<r;p=c+=1)i[s++]=t[o++];break;case 1:for(p=u=0;u<r;p=u+=1)l=t[o++],y=p<e?0:i[s-e],i[s++]=(l+y)%256;break;case 2:for(p=d=0;d<r;p=d+=1)l=t[o++],h=(p-p%e)/e,w=n&&i[(n-1)*r+h*e+p%e],i[s++]=(w+l)%256;break;case 3:for(p=f=0;f<r;p=f+=1)l=t[o++],h=(p-p%e)/e,y=p<e?0:i[s-e],w=n&&i[(n-1)*r+h*e+p%e],i[s++]=(l+Math.floor((y+w)/2))%256;break;case 4:for(p=m=0;m<r;p=m+=1)l=t[o++],h=(p-p%e)/e,y=p<e?0:i[s-e],0===n?w=F=0:(w=i[(n-1)*r+h*e+p%e],F=h&&i[(n-1)*r+(h-1)*e+p%e]),b=y+w-F,_=Math.abs(b-y),S=Math.abs(b-w),C=Math.abs(b-F),v=_<=S&&_<=C?y:S<=C?w:F,i[s++]=(l+v)%256;break;default:throw new Error(g(6018,t[o-1]))}n++}return i},e.copyToImageData=function(t,e){var r,i=this.hasAlphaChannel,a=this.colors;this.palette.length&&(r=null!=this._decodedPalette?this._decodedPalette:this._decodedPalette=this.decodePalette(),a=4,i=!0);var n=t.data||t,o=n.length,s=r||e,l=0,h=0,p=0,c=0;if(1===a)for(;l<o;)p=r?4*e[l/4]:h,c=s[p++],n[l++]=c,n[l++]=c,n[l++]=c,n[l++]=i?s[p++]:255,h=p;else for(;l<o;)p=r?4*e[l/4]:h,n[l++]=s[p++],n[l++]=s[p++],n[l++]=s[p++],n[l++]=i?s[p++]:255,h=p},e.decodePalette=function(){for(var t=this.palette,e=this.transparency.indexed||[],r=new Uint8Array((e.length||0)+t.length),i=0,a=0,n=0,o=0,s=0,l=t.length;s<l;o=s+=3)r[i++]=t[o],r[i++]=t[o+1],r[i++]=t[o+2],n=e[a++],r[i++]=null!=n?n:255;return r},e.render=function(t){t.width=this.width,t.height=this.height;var e=t.getContext("2d"),r=e.createImageData(this.width,this.height);return this.copyToImageData(r,this.decodePixels(null)),e.putImageData(r,0,0)},t}(),Je=function(){function t(){this._littleEndian=!1,this._tiffData=[],this._fileDirectories=[]}var e=t.prototype;return e.getUint8=function(t){return this._tiffData[t]},e.getUint16=function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},e.getUint32=function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},e.checkLittleEndian=function(){var t=this.getUint16(0);if(18761===t)this._littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError(g(6019));this._littleEndian=!1}return this._littleEndian},e.hasTowel=function(){if(42!==this.getUint16(2))throw RangeError(g(6020));return!0},e.getFieldTypeName=function(t){return t in Qe?Qe[t]:null},e.getFieldTagName=function(t){return t in Ke?Ke[t]:(b(6021,t),"Tag"+t)},e.getFieldTypeLength=function(t){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)?1:-1!==["SHORT","SSHORT"].indexOf(t)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(t)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)?8:0},e.getFieldValues=function(t,e,r,i){var a=[],n=this.getFieldTypeLength(e);if(n*r<=4)!1===this._littleEndian?a.push(i>>>8*(4-n)):a.push(i);else for(var o=0;o<r;o++){var s=n*o;n>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(e)?(a.push(this.getUint32(i+s)),a.push(this.getUint32(i+s+4))):b(8e3):a.push(this.getBytes(n,i+s))}return"ASCII"===e&&a.forEach((function(t,e,r){r[e]=String.fromCharCode(t)})),a},e.getBytes=function(t,e){if(t<=0)b(8001);else{if(t<=1)return this.getUint8(e);if(t<=2)return this.getUint16(e);if(t<=3)return this.getUint32(e)>>>8;if(t<=4)return this.getUint32(e);b(8002)}return 0},e.getBits=function(t,e,r){r=r||0;var i=e+Math.floor(r/8),a=r+t,n=32-t,o=0,s=0;return a<=0?b(6023):a<=8?(o=24+r,s=this.getUint8(i)):a<=16?(o=16+r,s=this.getUint16(i)):a<=32?(o=r,s=this.getUint32(i)):b(6022),{bits:s<<o>>>n,byteOffset:i+Math.floor(a/8),bitOffset:a%8}},e.parseFileDirectory=function(t){var e=this.getUint16(t),r=[],i=0,a=0;for(i=t+2,a=0;a<e;i+=12,a++){var n=this.getUint16(i),o=this.getUint16(i+2),s=this.getUint32(i+4),l=this.getUint32(i+8),h=this.getFieldTagName(n),p=this.getFieldTypeName(o),c=this.getFieldValues(h,p,s,l);r[h]={type:p,values:c}}this._fileDirectories.push(r);var u=this.getUint32(i);0!==u&&this.parseFileDirectory(u)},e.clampColorSample=function(t,e){var r=Math.pow(2,8-e);return Math.floor(t*r+(r-1))},e.parseTIFF=function(t,e){var r=this;if(e=e||document.createElement("canvas"),this._tiffData=t,this._canvas=e,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var a=this._fileDirectories[0],n=a.ImageWidth.values[0],o=a.ImageLength.values[0];this._canvas.width=n,this._canvas.height=o;var s=[],l=a.Compression?a.Compression.values[0]:1,h=a.SamplesPerPixel.values[0],p=[],c=0,u=!1;a.BitsPerSample.values.forEach((function(t,e){p[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},t%8==0&&(p[e].hasBytesPerSample=!0,p[e].bytesPerSample=t/8),c+=t}),this);var d=0;c%8==0&&(u=!0,d=c/8);var f,m=a.StripOffsets.values,y=m.length;if(a.StripByteCounts)f=a.StripByteCounts.values;else{if(b(8003),1!==y)throw Error(g(6024));f=[Math.ceil(n*o*c/8)]}for(var _=1,v=1,S=0;S<y;S++){var C=m[S];s[S]=[];for(var w=f[S],F=0,P=0,T=1,D=!0,A=[],R=0,V=0,x=0;F<w;F+=T)switch(l){case 1:A=[];for(var O=0;O<h;O++){var I=p[O];if(!I.hasBytesPerSample){var E=this.getBits(I.bitsPerSample,C+F,P);throw A.push(E.bits),F=E.byteOffset-C,P=E.bitOffset,RangeError(g(6025))}var z=I.bytesPerSample*O;A.push(this.getBytes(I.bytesPerSample,C+F+z))}if(s[S].push(A),!u)throw T=0,RangeError(g(6026));T=d;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(D){D=!1;var M=this.getUint8(C+F);M>=0&&M<=127?_=M+1:M>=-127&&M<=-1?v=1-M:D=!0}else{for(var U=this.getUint8(C+F),k=0;k<v;k++){var L=p[V];if(!L.hasBytesPerSample)throw RangeError(g(6025));x=x<<8*R|U,++R===L.bytesPerSample&&(A.push(x),x=R=0,V++),V===h&&(s[S].push(A),A=[],V=0)}0==--_&&(D=!0)}T=1}}if(e.getContext){var N=this._canvas.getContext("2d");N.fillStyle="rgba(255, 255, 255, 0)";var B=a.RowsPerStrip?a.RowsPerStrip.values[0]:o,j=s.length,G=o%B,W=0===G?B:G,Y=B,H=0,q=a.PhotometricInterpretation.values[0],X=[],Z=0;a.ExtraSamples&&(Z=(X=a.ExtraSamples.values).length);var J=[],K=0;a.ColorMap&&(J=a.ColorMap.values,K=Math.pow(2,p[0].bitsPerSample));for(var Q=0;Q<j;Q++){Q+1===j&&(Y=W);for(var $=s[Q].length,tt=H*Q,et=0,rt=0;et<Y&&rt<$;et++)for(var it=0;it<n;it++,rt++){var at=s[Q][rt],nt=0,ot=0,st=0,lt=1;if(Z>0)for(var ht=0;ht<Z;ht++)if(1===X[ht]||2===X[ht]){lt=at[3+ht]/256;break}!function(){switch(q){case 0:var t=0;p[0].hasBytesPerSample&&(t=Math.pow(16,2*p[0].bytesPerSample)),at.forEach((function(e,r,i){i[r]=t-e}));case 1:nt=ot=st=r.clampColorSample(at[0],p[0].bitsPerSample);break;case 2:nt=r.clampColorSample(at[0],p[0].bitsPerSample),ot=r.clampColorSample(at[1],p[1].bitsPerSample),st=r.clampColorSample(at[2],p[2].bitsPerSample);break;case 3:if(void 0===J)throw Error(g(6027));var e=at[0];nt=r.clampColorSample(J[e],16),ot=r.clampColorSample(J[K+e],16),st=r.clampColorSample(J[2*K+e],16);break;default:throw RangeError(g(6028,q))}}(),N.fillStyle="rgba("+nt+", "+ot+", "+st+", "+lt+")",N.fillRect(it,tt+et,1,1)}H=Y}}return this._canvas}},t}(),Ke={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},Qe={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"};function $e(t){var e=t.parent,r=t.getComponent(fr);return e&&r?$e(e):t.getComponentsInChildren(fr)}!function(t){t[t.JPG=0]="JPG",t[t.PNG=1]="PNG",t[t.TIFF=2]="TIFF",t[t.WEBP=3]="WEBP",t[t.PVR=4]="PVR",t[t.ETC=5]="ETC",t[t.S3TC=6]="S3TC",t[t.ATITC=7]="ATITC",t[t.TGA=8]="TGA",t[t.RAWDATA=9]="RAWDATA",t[t.UNKNOWN=10]="UNKNOWN"}(Xe||(Xe={}));var tr,er,rr,ir,ar,nr,or,sr,lr,hr,pr,cr,ur,dr,fr=t("ParticleSystem2D",(nt=h("cc.ParticleSystem2D"),ot=V(),st=x(),lt=_(at),ht=x(),pt=_(M),ct=x(),ut=x(),dt=x(),ft=x(),mt=x(),yt=x(),gt=x(),bt=x(),_t=O(),vt=x(),St=x(),Ct=x(),wt=x(),Ft=x(),Pt=x(),Tt=x(),Dt=x(),At=x(),Rt=x(),Vt=x(),xt=x(),Ot=x(),It=_(X),Et=x(),zt=_(q),Mt=x(),Ut=x(),kt=x(),Lt=x(),Nt=x(),Bt=x(),jt=x(),Gt=x(),Wt=x(),Yt=x(),Ht=x(),qt=x(),Xt=x(),Zt=x(),Jt=x(),Kt=x(),Qt=x(),$t=v("preview"),te=x(),nt(ee=ot(ee=S(ee=C((qe=He=function(t){function e(){var e;return e=t.call(this)||this,u(e,"duration",ie,d(e)),u(e,"emissionRate",ae,d(e)),u(e,"life",ne,d(e)),u(e,"lifeVar",oe,d(e)),u(e,"angle",se,d(e)),u(e,"angleVar",le,d(e)),u(e,"startSize",he,d(e)),u(e,"startSizeVar",pe,d(e)),u(e,"endSize",ce,d(e)),u(e,"endSizeVar",ue,d(e)),u(e,"startSpin",de,d(e)),u(e,"startSpinVar",fe,d(e)),u(e,"endSpin",me,d(e)),u(e,"endSpinVar",ye,d(e)),u(e,"sourcePos",ge,d(e)),u(e,"posVar",be,d(e)),u(e,"emitterMode",_e,d(e)),u(e,"gravity",ve,d(e)),u(e,"speed",Se,d(e)),u(e,"speedVar",Ce,d(e)),u(e,"tangentialAccel",we,d(e)),u(e,"tangentialAccelVar",Fe,d(e)),u(e,"radialAccel",Pe,d(e)),u(e,"radialAccelVar",Te,d(e)),u(e,"rotationIsDir",De,d(e)),u(e,"startRadius",Ae,d(e)),u(e,"startRadiusVar",Re,d(e)),u(e,"endRadius",Ve,d(e)),u(e,"endRadiusVar",xe,d(e)),u(e,"rotatePerS",Oe,d(e)),u(e,"rotatePerSVar",Ie,d(e)),e.aspectRatio=1,u(e,"playOnLoad",Ee,d(e)),u(e,"autoRemoveOnFinish",ze,d(e)),u(e,"_preview",Me,d(e)),u(e,"_custom",Ue,d(e)),u(e,"_file",ke,d(e)),u(e,"_spriteFrame",Le,d(e)),u(e,"_totalParticles",Ne,d(e)),u(e,"_startColor",Be,d(e)),u(e,"_startColorVar",je,d(e)),u(e,"_endColor",Ge,d(e)),u(e,"_endColorVar",We,d(e)),u(e,"_positionType",Ye,d(e)),e._stopped=!0,e.initProperties(),e}i(e,t);var r=e.prototype;return r.onEnable=function(){t.prototype.onEnable.call(this),this._updateMaterial()},r.onDestroy=function(){t.prototype.onDestroy.call(this),this.autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._simulator.uvFilled=0},r.initProperties=function(){this._previewTimer=null,this._focused=!1,this.aspectRatio=1,this._simulator=new it(this)},r.onFocusInEditor=function(){this._focused=!0;for(var t=$e(this.node),e=0;e<t.length;++e)t[e]._startPreview()},r.onLostFocusInEditor=function(){this._focused=!1;for(var t=$e(this.node),e=0;e<t.length;++e)t[e]._stopPreview()},r._startPreview=function(){this._preview&&this.resetSystem()},r._stopPreview=function(){this._preview&&(this.resetSystem(),this.stopSystem()),this._previewTimer&&clearInterval(this._previewTimer)},r.__preload=function(){t.prototype.__preload.call(this),this._custom&&this.spriteFrame&&!this._renderSpriteFrame?this._applySpriteFrame():this._file&&(this._custom?!this._getTexture()&&this._applyFile():this._applyFile()),this.playOnLoad&&this.resetSystem()},r._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this._assembler&&this._assembler.createData&&(this._simulator.renderData=this._assembler.createData(this))},r.lateUpdate=function(t){this._simulator.finished||this._simulator.step(t)},r.addParticle=function(){},r.stopSystem=function(){this._stopped=!0,this._simulator.stop()},r.resetSystem=function(){this._stopped=!1,this._simulator.reset(),this._renderFlag=this._canRender()},r.isFull=function(){return this.particleCount>=this.totalParticles},r._applyFile=function(){var t=this._file;if(t){if(!t)return void w(6029);if(!this.isValid)return;this._plistFile=t.nativeUrl,this._custom||(this._spriteFrame!==t.spriteFrame&&(this.spriteFrame=t.spriteFrame),this._initWithDictionary(t._nativeAsset)),this._spriteFrame?!this._renderSpriteFrame&&this._spriteFrame&&this._applySpriteFrame():t.spriteFrame?this.spriteFrame=t.spriteFrame:this._custom&&this._initTextureWithDictionary(t._nativeAsset)}},r._initTextureWithDictionary=function(t){var e,r=this;if(t.spriteFrameUuid){var i=t.spriteFrameUuid;z.loadAny(i,(function(e,i){e?(t.spriteFrameUuid=void 0,r._initTextureWithDictionary(t),F(e)):r.spriteFrame=i}))}else{var a=P(this._plistFile,t.textureFileName||"");if(t.textureFileName)z.loadRemote(a,(function(e,i){e?(t.textureFileName=void 0,r._initTextureWithDictionary(t),F(e)):r.spriteFrame=M.createWithImage(i)}));else if(t.textureImageData){var n=t.textureImageData;if(!(n&&n.length>0))return!1;var o=z.assets.get(a);if(!o){var s=j.unzipBase64AsArray(n,1);if(!s)return T(6030,this._file.name),!1;var l=(e=s).length>8&&137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]?Xe.PNG:e.length>2&&(73===e[0]&&73===e[1]||77===e[0]&&77===e[1]||255===e[0]&&216===e[1])?Xe.TIFF:Xe.UNKNOWN;if(l!==Xe.TIFF&&l!==Xe.PNG)return T(6031,this._file.name),!1;var h=document.createElement("canvas");l===Xe.PNG?new Ze(s).render(h):(this._tiffReader||(this._tiffReader=new Je),this._tiffReader.parseTIFF(s,h)),o=new D(h),z.assets.add(a,o)}o||T(6032,this._file.name),this.spriteFrame=M.createWithImage(o)}}return!0},r._initWithDictionary=function(t){this.totalParticles=parseInt(t.maxParticles||0),this.life=parseFloat(t.particleLifespan||0),this.lifeVar=parseFloat(t.particleLifespanVariance||0);var e=t.emissionRate;this.emissionRate=e||Math.min(this.totalParticles/this.life,Number.MAX_VALUE),this.duration=parseFloat(t.duration||0),this._srcBlendFactor=parseInt(t.blendFuncSource||A.SRC_ALPHA),this._dstBlendFactor=parseInt(t.blendFuncDestination||A.ONE_MINUS_SRC_ALPHA);var r=this._startColor;r.r=255*parseFloat(t.startColorRed||0),r.g=255*parseFloat(t.startColorGreen||0),r.b=255*parseFloat(t.startColorBlue||0),r.a=255*parseFloat(t.startColorAlpha||0);var i=this._startColorVar;i.r=255*parseFloat(t.startColorVarianceRed||0),i.g=255*parseFloat(t.startColorVarianceGreen||0),i.b=255*parseFloat(t.startColorVarianceBlue||0),i.a=255*parseFloat(t.startColorVarianceAlpha||0);var a=this._endColor;a.r=255*parseFloat(t.finishColorRed||0),a.g=255*parseFloat(t.finishColorGreen||0),a.b=255*parseFloat(t.finishColorBlue||0),a.a=255*parseFloat(t.finishColorAlpha||0);var n=this._endColorVar;if(n.r=255*parseFloat(t.finishColorVarianceRed||0),n.g=255*parseFloat(t.finishColorVarianceGreen||0),n.b=255*parseFloat(t.finishColorVarianceBlue||0),n.a=255*parseFloat(t.finishColorVarianceAlpha||0),this.startSize=parseFloat(t.startParticleSize||0),this.startSizeVar=parseFloat(t.startParticleSizeVariance||0),this.endSize=parseFloat(t.finishParticleSize||0),this.endSizeVar=parseFloat(t.finishParticleSizeVariance||0),this.positionType=parseFloat(void 0!==t.positionType?t.positionType:X.FREE),this.sourcePos.set(0,0),this.posVar.set(parseFloat(t.sourcePositionVariancex||0),parseFloat(t.sourcePositionVariancey||0)),this.angle=parseFloat(t.angle||0),this.angleVar=parseFloat(t.angleVariance||0),this.startSpin=parseFloat(t.rotationStart||0),this.startSpinVar=parseFloat(t.rotationStartVariance||0),this.endSpin=parseFloat(t.rotationEnd||0),this.endSpinVar=parseFloat(t.rotationEndVariance||0),this.emitterMode=parseInt(t.emitterType||q.GRAVITY),this.emitterMode===q.GRAVITY){this.gravity.set(parseFloat(t.gravityx||0),parseFloat(t.gravityy||0)),this.speed=parseFloat(t.speed||0),this.speedVar=parseFloat(t.speedVariance||0),this.radialAccel=parseFloat(t.radialAcceleration||0),this.radialAccelVar=parseFloat(t.radialAccelVariance||0),this.tangentialAccel=parseFloat(t.tangentialAcceleration||0),this.tangentialAccelVar=parseFloat(t.tangentialAccelVariance||0);var o=t.rotationIsDir||"";null!==o?(o=o.toString().toLowerCase(),this.rotationIsDir="true"===o||"1"===o):this.rotationIsDir=!1}else{if(this.emitterMode!==q.RADIUS)return T(6009),!1;this.startRadius=parseFloat(t.maxRadius||0),this.startRadiusVar=parseFloat(t.maxRadiusVariance||0),this.endRadius=parseFloat(t.minRadius||0),this.endRadiusVar=parseFloat(t.minRadiusVariance||0),this.rotatePerS=parseFloat(t.rotatePerSecond||0),this.rotatePerSVar=parseFloat(t.rotatePerSecondVariance||0)}return this._initTextureWithDictionary(t),!0},r._syncAspect=function(){if(this._renderSpriteFrame){var t=this._renderSpriteFrame.rect;this.aspectRatio=t.width/t.height}},r._applySpriteFrame=function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator.updateUVs(!0),this._syncAspect(),this._updateMaterial(),this._stopped=!1,this._renderFlag=this._canRender()):this.resetSystem()},r._getTexture=function(){return this._renderSpriteFrame&&this._renderSpriteFrame.texture},r._updateMaterial=function(){var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this._positionType!==X.FREE})},r._finishedSimulation=function(){this.resetSystem(),this.stopSystem(),this._renderFlag=this._canRender(),this.autoRemoveOnFinish&&this._stopped&&this.node.destroy()},r._canRender=function(){return t.prototype._canRender.call(this)&&!this._stopped&&null!==this._renderSpriteFrame},r._render=function(t){this._positionType===X.RELATIVE?t.commitComp(this,this._renderSpriteFrame,this._assembler,this.node.parent):this.positionType===X.GROUPED?t.commitComp(this,this._renderSpriteFrame,this._assembler,this.node):t.commitComp(this,this._renderSpriteFrame,this._assembler,null)},R(e,[{key:"custom",get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,this._applyFile())}},{key:"file",get:function(){return this._file},set:function(t){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){this._renderSpriteFrame!==t&&(this._renderSpriteFrame=t,t&&!t._uuid||(this._spriteFrame=t),this._applySpriteFrame())}},{key:"particleCount",get:function(){return this._simulator.particles.length}},{key:"totalParticles",get:function(){return this._totalParticles},set:function(t){this._totalParticles!==t&&(this._totalParticles=t)}},{key:"startColor",get:function(){return this._startColor},set:function(t){this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._startColor.a=t.a}},{key:"startColorVar",get:function(){return this._startColorVar},set:function(t){this._startColorVar.r=t.r,this._startColorVar.g=t.g,this._startColorVar.b=t.b,this._startColorVar.a=t.a}},{key:"color",get:function(){return this._color},set:function(){}},{key:"endColor",get:function(){return this._endColor},set:function(t){this._endColor.r=t.r,this._endColor.g=t.g,this._endColor.b=t.b,this._endColor.a=t.a}},{key:"endColorVar",get:function(){return this._endColorVar},set:function(t){this._endColorVar.r=t.r,this._endColorVar.g=t.g,this._endColorVar.b=t.b,this._endColorVar.a=t.a}},{key:"positionType",get:function(){return this._positionType},set:function(t){this._positionType=t,this._updateMaterial()}},{key:"preview",get:function(){return this._preview},set:function(t){t?this._startPreview():this._stopPreview(),this._preview=t}},{key:"stopped",get:function(){return this._stopped}},{key:"active",get:function(){return this._simulator.active}},{key:"assembler",get:function(){return this._assembler}}]),e}(U),He.EmitterMode=q,He.PositionType=X,He.DURATION_INFINITY=-1,He.START_SIZE_EQUAL_TO_END_SIZE=-1,He.START_RADIUS_EQUAL_TO_END_RADIUS=-1,p((re=qe).prototype,"custom",[y,st],Object.getOwnPropertyDescriptor(re.prototype,"custom"),re.prototype),p(re.prototype,"file",[lt,ht],Object.getOwnPropertyDescriptor(re.prototype,"file"),re.prototype),p(re.prototype,"spriteFrame",[pt,ct],Object.getOwnPropertyDescriptor(re.prototype,"spriteFrame"),re.prototype),p(re.prototype,"totalParticles",[y,ut],Object.getOwnPropertyDescriptor(re.prototype,"totalParticles"),re.prototype),ie=p(re.prototype,"duration",[m,y,dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),ae=p(re.prototype,"emissionRate",[m,y,ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),ne=p(re.prototype,"life",[m,y,mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),oe=p(re.prototype,"lifeVar",[m,y,yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),p(re.prototype,"startColor",[y,gt],Object.getOwnPropertyDescriptor(re.prototype,"startColor"),re.prototype),p(re.prototype,"startColorVar",[y,bt],Object.getOwnPropertyDescriptor(re.prototype,"startColorVar"),re.prototype),p(re.prototype,"color",[_t],Object.getOwnPropertyDescriptor(re.prototype,"color"),re.prototype),p(re.prototype,"endColor",[y,vt],Object.getOwnPropertyDescriptor(re.prototype,"endColor"),re.prototype),p(re.prototype,"endColorVar",[y,St],Object.getOwnPropertyDescriptor(re.prototype,"endColorVar"),re.prototype),se=p(re.prototype,"angle",[m,y,Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 90}}),le=p(re.prototype,"angleVar",[m,y,wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),he=p(re.prototype,"startSize",[m,y,Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),pe=p(re.prototype,"startSizeVar",[m,y,Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ce=p(re.prototype,"endSize",[m,y,Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ue=p(re.prototype,"endSizeVar",[m,y,Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),de=p(re.prototype,"startSpin",[m,y,At],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),fe=p(re.prototype,"startSpinVar",[m,y,Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),me=p(re.prototype,"endSpin",[m,y,Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ye=p(re.prototype,"endSpinVar",[m,y,xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ge=p(re.prototype,"sourcePos",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return r.ZERO.clone()}}),be=p(re.prototype,"posVar",[m,y,Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return r.ZERO.clone()}}),p(re.prototype,"positionType",[It,Et],Object.getOwnPropertyDescriptor(re.prototype,"positionType"),re.prototype),p(re.prototype,"preview",[y],Object.getOwnPropertyDescriptor(re.prototype,"preview"),re.prototype),_e=p(re.prototype,"emitterMode",[m,y,zt,Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return q.GRAVITY}}),ve=p(re.prototype,"gravity",[m,y,Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return r.ZERO.clone()}}),Se=p(re.prototype,"speed",[m,y,kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 180}}),Ce=p(re.prototype,"speedVar",[m,y,Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),we=p(re.prototype,"tangentialAccel",[m,y,Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),Fe=p(re.prototype,"tangentialAccelVar",[m,y,Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Pe=p(re.prototype,"radialAccel",[m,y,jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Te=p(re.prototype,"radialAccelVar",[m,y,Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),De=p(re.prototype,"rotationIsDir",[m,y,Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ae=p(re.prototype,"startRadius",[m,y,Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Re=p(re.prototype,"startRadiusVar",[m,y,Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ve=p(re.prototype,"endRadius",[m,y,qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),xe=p(re.prototype,"endRadiusVar",[m,y,Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Oe=p(re.prototype,"rotatePerS",[m,y,Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ie=p(re.prototype,"rotatePerSVar",[m,y,Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ee=p(re.prototype,"playOnLoad",[m,y,Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ze=p(re.prototype,"autoRemoveOnFinish",[m,y,Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Me=p(re.prototype,"_preview",[$t,y,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ue=p(re.prototype,"_custom",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ke=p(re.prototype,"_file",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=p(re.prototype,"_spriteFrame",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=p(re.prototype,"_totalParticles",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),Be=p(re.prototype,"_startColor",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a(255,255,255,255)}}),je=p(re.prototype,"_startColorVar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a(0,0,0,0)}}),Ge=p(re.prototype,"_endColor",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a(255,255,255,0)}}),We=p(re.prototype,"_endColorVar",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new a(0,0,0,0)}}),Ye=p(re.prototype,"_positionType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return X.FREE}}),ee=re))||ee)||ee)||ee)||ee)),mr=function(){function t(t,e){this.point=new r,this.dir=new r,this.distance=0,this.time=0,t&&this.point.set(t),e&&this.dir.set(e)}var e=t.prototype;return e.setPoint=function(t,e){this.point.x=t,this.point.y=e},e.setDir=function(t,e){this.dir.x=t,this.dir.y=e},t}(),yr=t("MotionStreak",(tr=h("cc.MotionStreak"),er=V(),rr=E(),ir=_(I),tr(ar=C(ar=S(ar=er(ar=rr((dr=ur=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,u(e,"_preview",or,d(e)),u(e,"_fadeTime",sr,d(e)),u(e,"_minSeg",lr,d(e)),u(e,"_stroke",hr,d(e)),u(e,"_texture",pr,d(e)),u(e,"_fastMode",cr,d(e)),e._points=[],e}i(e,t);var r=e.prototype;return r.onEnable=function(){t.prototype.onEnable.call(this),this.reset()},r._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this._renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this._renderData.material=this.material)},r.onFocusInEditor=function(){this._preview&&this.reset()},r.onLostFocusInEditor=function(){this._preview&&this.reset()},r.reset=function(){this._points.length=0,this._renderData&&this._renderData.clear()},r.lateUpdate=function(t){this._assembler&&this._assembler.update(this,t)},r._render=function(t){t.commitComp(this,this._texture,this._assembler,null)},R(e,[{key:"preview",get:function(){return this._preview},set:function(t){this._preview=t,this.reset()}},{key:"fadeTime",get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this.reset()}},{key:"minSeg",get:function(){return this._minSeg},set:function(t){this._minSeg=t}},{key:"stroke",get:function(){return this._stroke},set:function(t){this._stroke=t}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t)}},{key:"fastMode",get:function(){return this._fastMode},set:function(t){this._fastMode=t}},{key:"points",get:function(){return this._points}}]),e}(U),ur.Point=mr,p((nr=dr).prototype,"preview",[y],Object.getOwnPropertyDescriptor(nr.prototype,"preview"),nr.prototype),p(nr.prototype,"fadeTime",[y],Object.getOwnPropertyDescriptor(nr.prototype,"fadeTime"),nr.prototype),p(nr.prototype,"minSeg",[y],Object.getOwnPropertyDescriptor(nr.prototype,"minSeg"),nr.prototype),p(nr.prototype,"stroke",[y],Object.getOwnPropertyDescriptor(nr.prototype,"stroke"),nr.prototype),p(nr.prototype,"texture",[ir],Object.getOwnPropertyDescriptor(nr.prototype,"texture"),nr.prototype),p(nr.prototype,"fastMode",[y],Object.getOwnPropertyDescriptor(nr.prototype,"fastMode"),nr.prototype),or=p(nr.prototype,"_preview",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sr=p(nr.prototype,"_fadeTime",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),lr=p(nr.prototype,"_minSeg",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),hr=p(nr.prototype,"_stroke",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 64}}),pr=p(nr.prototype,"_texture",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cr=p(nr.prototype,"_fastMode",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ar=nr))||ar)||ar)||ar)||ar)||ar)),gr=(new r,new r),br=new r;function _r(t,e){return t.x=-e.y,t.y=e.x,t}var vr={createData:function(t){var e=t.requestRenderData();return e.dataLength=4,e.vertexCount=16,e.indicesCount=42,e},update:function(t,e){var i,a=t.stroke/2,n=t.node.worldMatrix,o=n.m12,s=n.m13,l=t.points;if(l.length>1){var h=l[0],p=h.point.x-o,c=h.point.y-s;p*p+c*c<t.minSeg&&(i=h)}i||(i=new yr.Point,l.unshift(i)),i.setPoint(o,s),i.time=t.fadeTime+e;var u,d=0;if(!(l.length<2)){var f=t.renderData,m=t.color,y=m.r,g=m.g,b=m.b,_=m.a,v=l[1];v.distance=r.subtract(br,i.point,v.point).length(),br.normalize(),v.setDir(br.x,br.y),i.setDir(br.x,br.y),f.dataLength=2*l.length;for(var S=f.data,C=t.fadeTime,w=!1,F=l.length-1;F>=0;F--){var P=l[F],T=P.point,D=P.dir;if(P.time-=e,P.time<0)l.splice(F,1);else{var A=P.time/C,R=l[F-1];if(!w){if(!R){l.splice(F,1);continue}T.x=R.point.x-D.x*A,T.y=R.point.y-D.y*A}w=!0,_r(gr,D);var V=(A*_<<24>>>0)+(b<<16)+(g<<8)+y,x=d;S[x].x=T.x+gr.x*a,S[x].y=T.y+gr.y*a,S[x].u=1,S[x].v=A,S[x].color._val=V,S[x+=1].x=T.x-gr.x*a,S[x].y=T.y-gr.y*a,S[x].u=0,S[x].v=A,S[x].color._val=V,d+=2}}u=d<=2?0:3*(d-2),f.vertexCount=d,f.indicesCount=u}},updateRenderData:function(){},fillBuffers:function(t,e){var r=t.renderData,i=r.data,n=(t.node,e.acquireBufferBatch()),o=n.byteOffset>>2,s=n.indicesOffset,l=n.vertexOffset;n.request(r.vertexCount,r.indicesCount)||(n=e.currBufferBatch,s=0,l=0);for(var h=n.vData,p=n.iData,c=r.vertexCount,u=r.indicesCount,d=0;d<c;d++){var f=i[d];h[o++]=f.x,h[o++]=f.y,h[o++]=f.z,h[o++]=f.u,h[o++]=f.v,a.toArray(h,f.color,o),o+=4}for(var m=0,y=u;m<y;m+=2){var g=l+m;p[s++]=g,p[s++]=g+2,p[s++]=g+1,p[s++]=g+1,p[s++]=g+2,p[s++]=g+3}}},Sr=t("MotionStreakAssemblerManager",{getAssembler:function(){return vr}});yr.Assembler=Sr;var Cr={maxParticleDeltaTime:0,createData:function(){return k.add()},updateRenderData:function(){},fillBuffers:function(t,e){if(null!==t){var r=t._simulator.renderData;if(0!==r.vertexCount&&0!==r.indicesCount){var i=e.acquireBufferBatch(),a=i.byteOffset>>2,n=i.indicesOffset,o=i.vertexOffset;i.request(r.vertexCount,r.indicesCount)||(i=e.currBufferBatch,n=0,o=0);for(var s=i.vData,l=i.iData,h=r.vData,p=r.iData,c=9*r.vertexCount,u=0;u<c;u++)s[a++]=h[u];for(var d=r.indicesCount,f=0;f<d;f++)l[n++]=p[f]+o}}}},wr=t("ParticleSystem2DAssembler",{getAssembler:function(){return Cr.maxParticleDeltaTime||(Cr.maxParticleDeltaTime=c.game.frameTime/1e3*2),Cr}});fr.Assembler=wr}}}));
