System.register(["./json-asset-1f2be75e.js","./view-368b93a3.js"],(function(t){"use strict";var e,r,i,o,a,n,c,s,h,p,_,u,l,f,y,m,g,b,d,w,T,v,O,x,S,j,C,D,E,P,z,k,A;return{setters:[function(t){e=t.c5,r=t.cJ,i=t.ac,o=t.ee,a=t.ej,n=t.dI,c=t.dr,s=t.fX,h=t.eb,p=t.ea,_=t.e0,u=t.l,l=t.cr,f=t.e1,y=t.ef,m=t.fY,g=t.fZ,b=t.ei,d=t.fT,w=t.eg,T=t.ec,v=t.dN,O=t.eh,x=t.cj,S=t.ch,j=t.d_},function(t){C=t.a,D=t.C,E=t.b,P=t.d,z=t.c,k=t.S,A=t.v}],execute:function(){var F,H,I,R,L,N,W,M,V,X,G,U,Y,B,J,K,Z,q,Q,$,tt,et,rt,it,ot,at,nt,ct,st,ht,pt,_t,ut,lt,ft,yt,mt,gt,bt,dt,wt,Tt,vt,Ot,xt,St,jt,Ct,Dt,Et,Pt,zt,kt,At,Ft,Ht,It,Rt,Lt,Nt,Wt,Mt,Vt,Xt,Gt,Ut,Yt,Bt=new e,Jt=r(C),Kt=r(D),Zt=r(E),qt=r(P),Qt=r(z),$t=r({SKYBOX:k|i.DEPTH_STENCIL,SOLID_COLOR:i.ALL,DEPTH_ONLY:i.DEPTH_STENCIL,DONT_CLEAR:i.NONE}),te=t("C",(F=o("cc.Camera"),H=m(),I=g(),R=b(),L=d(),N=a(n.BitMask),W=b(),M=d(),V=a($t),X=b(),G=d(),U=b(),Y=d(),B=b(),J=d(),K=b(),Z=d(),q=a(Jt),Q=b(),$=d(),tt=a(Kt),et=b(),rt=d(),it=b(),ot=d(),at=b(),nt=d(),ct=b(),st=d(),ht=b(),pt=d(),_t=a(Zt),ut=b(),lt=d(),ft=a(qt),yt=b(),mt=d(),gt=a(Qt),bt=b(),dt=d(),wt=b(),Tt=d(),vt=a(c),Ot=b(),xt=d(),F(St=H(St=I(St=s((Yt=Ut=function(t){function r(){for(var e,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,w(e,"_projection",Ct,T(e)),w(e,"_priority",Dt,T(e)),w(e,"_fov",Et,T(e)),w(e,"_fovAxis",Pt,T(e)),w(e,"_orthoHeight",zt,T(e)),w(e,"_near",kt,T(e)),w(e,"_far",At,T(e)),w(e,"_color",Ft,T(e)),w(e,"_depth",Ht,T(e)),w(e,"_stencil",It,T(e)),w(e,"_clearFlags",Rt,T(e)),w(e,"_rect",Lt,T(e)),w(e,"_aperture",Nt,T(e)),w(e,"_shutter",Wt,T(e)),w(e,"_iso",Mt,T(e)),w(e,"_screenScale",Vt,T(e)),w(e,"_visibility",Xt,T(e)),w(e,"_targetTexture",Gt,T(e)),e._camera=null,e._inEditorMode=!1,e._flows=void 0,e}h(r,t);var i=r.prototype;return i.onLoad=function(){this._createCamera()},i.onEnable=function(){this.node.hasChangedFlags|=p.POSITION,this._camera&&this._attachToScene()},i.onDisable=function(){this._camera&&this._detachFromScene()},i.onDestroy=function(){this._camera&&(this._camera.destroy(),this._camera=null),this._targetTexture&&this._targetTexture.off("resize")},i.screenPointToRay=function(t,e,r){return r||(r=_.create()),this._camera&&this._camera.screenPointToRay(r,t,e),r},i.worldToScreen=function(t,r){return r||(r=new e),this._camera&&this._camera.worldToScreen(r,t),r},i.screenToWorld=function(t,e){return e||(e=this.node.getWorldPosition()),this._camera&&this._camera.screenToWorld(e,t),e},i.convertToUINode=function(t,r,i){if(i||(i=new e),!this._camera)return i;this.worldToScreen(t,Bt);var o=r.getComponent("cc.UITransform"),a=A.getVisibleSize(),n=Bt.x-.5*this._camera.width,c=Bt.y-.5*this._camera.height;return Bt.x=n/u.view.getScaleX()+.5*a.width,Bt.y=c/u.view.getScaleY()+.5*a.height,o&&o.convertToNodeSpaceAR(Bt,i),i},i._createCamera=function(){this._camera||(this._camera=u.director.root.createCamera(),this._camera.initialize({name:this.node.name,node:this.node,projection:this._projection,window:this._inEditorMode?u.director.root&&u.director.root.mainWindow:u.director.root&&u.director.root.tempWindow,priority:this._priority}),this._camera.viewport=this._rect,this._camera.fovAxis=this._fovAxis,this._camera.fov=l(this._fov),this._camera.orthoHeight=this._orthoHeight,this._camera.nearClip=this._near,this._camera.farClip=this._far,this._camera.clearColor=this._color,this._camera.clearDepth=this._depth,this._camera.clearStencil=this._stencil,this._camera.clearFlag=this._clearFlags,this._camera.visibility=this._visibility,this._camera.aperture=this._aperture,this._camera.shutter=this._shutter,this._camera.iso=this._iso),this._updateTargetTexture()},i._attachToScene=function(){this.node.scene&&this._camera&&(this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera),this._getRenderScene().addCamera(this._camera))},i._detachFromScene=function(){this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera)},i._checkTargetTextureEvent=function(t){var e=this;t&&t.off("resize"),this._targetTexture&&this._targetTexture.on("resize",(function(t){e._camera&&e._camera.setFixedSize(t.width,t.height)}),this)},i._updateTargetTexture=function(){if(this._camera&&this._targetTexture){var t=this._targetTexture.window;this._camera.changeTargetWindow(t),this._camera.setFixedSize(t.width,t.height)}},f(r,[{key:"camera",get:function(){return this._camera}},{key:"priority",get:function(){return this._priority},set:function(t){this._priority=t,this._camera&&(this._camera.priority=t)}},{key:"visibility",get:function(){return this._visibility},set:function(t){this._visibility=t,this._camera&&(this._camera.visibility=t)}},{key:"clearFlags",get:function(){return this._clearFlags},set:function(t){this._clearFlags=t,this._camera&&(this._camera.clearFlag=t)}},{key:"clearColor",get:function(){return this._color},set:function(t){this._color.set(t),this._camera&&(this._camera.clearColor=this._color)}},{key:"clearDepth",get:function(){return this._depth},set:function(t){this._depth=t,this._camera&&(this._camera.clearDepth=t)}},{key:"clearStencil",get:function(){return this._stencil},set:function(t){this._stencil=t,this._camera&&(this._camera.clearStencil=t)}},{key:"projection",get:function(){return this._projection},set:function(t){this._projection=t,this._camera&&(this._camera.projectionType=t)}},{key:"fovAxis",get:function(){return this._fovAxis},set:function(t){t!==this._fovAxis&&(this._fovAxis=t,this._camera&&(this._camera.fovAxis=t,t===D.VERTICAL?this.fov=this._fov*this._camera.aspect:this.fov=this._fov/this._camera.aspect))}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t,this._camera&&(this._camera.fov=l(t))}},{key:"orthoHeight",get:function(){return this._orthoHeight},set:function(t){this._orthoHeight=t,this._camera&&(this._camera.orthoHeight=t)}},{key:"near",get:function(){return this._near},set:function(t){this._near=t,this._camera&&(this._camera.nearClip=t)}},{key:"far",get:function(){return this._far},set:function(t){this._far=t,this._camera&&(this._camera.farClip=t)}},{key:"aperture",get:function(){return this._aperture},set:function(t){this._aperture=t,this._camera&&(this._camera.aperture=t)}},{key:"shutter",get:function(){return this._shutter},set:function(t){this._shutter=t,this._camera&&(this._camera.shutter=t)}},{key:"iso",get:function(){return this._iso},set:function(t){this._iso=t,this._camera&&(this._camera.iso=t)}},{key:"rect",get:function(){return this._rect},set:function(t){this._rect=t,this._camera&&(this._camera.viewport=t)}},{key:"targetTexture",get:function(){return this._targetTexture},set:function(t){if(this._targetTexture!==t){var e=this._targetTexture;this._targetTexture=t,this._checkTargetTextureEvent(e),this._updateTargetTexture(),!t&&this._camera&&(this._camera.changeTargetWindow(null),this._camera.isWindowSize=!0),this.node.emit(r.TARGET_TEXTURE_CHANGE,this)}}},{key:"screenScale",get:function(){return this._screenScale},set:function(t){this._screenScale=t,this._camera&&(this._camera.screenScale=t)}},{key:"inEditorMode",get:function(){return this._inEditorMode},set:function(t){this._inEditorMode=t,this._camera&&this._camera.changeTargetWindow(t?u.director.root&&u.director.root.mainWindow:u.director.root&&u.director.root.tempWindow)}}]),r}(v),Ut.ProjectionType=Jt,Ut.FOVAxis=Kt,Ut.ClearFlag=$t,Ut.Aperture=Zt,Ut.Shutter=qt,Ut.ISO=Qt,Ut.TARGET_TEXTURE_CHANGE="tex-change",Ct=y((jt=Yt).prototype,"_projection",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Jt.PERSPECTIVE}}),Dt=y(jt.prototype,"_priority",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Et=y(jt.prototype,"_fov",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 45}}),Pt=y(jt.prototype,"_fovAxis",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Kt.VERTICAL}}),zt=y(jt.prototype,"_orthoHeight",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),kt=y(jt.prototype,"_near",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),At=y(jt.prototype,"_far",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),Ft=y(jt.prototype,"_color",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new x("#333333")}}),Ht=y(jt.prototype,"_depth",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),It=y(jt.prototype,"_stencil",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Rt=y(jt.prototype,"_clearFlags",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $t.SOLID_COLOR}}),Lt=y(jt.prototype,"_rect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S(0,0,1,1)}}),Nt=y(jt.prototype,"_aperture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Zt.F16_0}}),Wt=y(jt.prototype,"_shutter",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return qt.D125}}),Mt=y(jt.prototype,"_iso",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qt.ISO100}}),Vt=y(jt.prototype,"_screenScale",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Xt=y(jt.prototype,"_visibility",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j}}),Gt=y(jt.prototype,"_targetTexture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y(jt.prototype,"priority",[R,L],Object.getOwnPropertyDescriptor(jt.prototype,"priority"),jt.prototype),y(jt.prototype,"visibility",[N,W,M],Object.getOwnPropertyDescriptor(jt.prototype,"visibility"),jt.prototype),y(jt.prototype,"clearFlags",[V,X,G],Object.getOwnPropertyDescriptor(jt.prototype,"clearFlags"),jt.prototype),y(jt.prototype,"clearColor",[U,Y],Object.getOwnPropertyDescriptor(jt.prototype,"clearColor"),jt.prototype),y(jt.prototype,"clearDepth",[B,J],Object.getOwnPropertyDescriptor(jt.prototype,"clearDepth"),jt.prototype),y(jt.prototype,"clearStencil",[K,Z],Object.getOwnPropertyDescriptor(jt.prototype,"clearStencil"),jt.prototype),y(jt.prototype,"projection",[q,Q,$],Object.getOwnPropertyDescriptor(jt.prototype,"projection"),jt.prototype),y(jt.prototype,"fovAxis",[tt,et,rt],Object.getOwnPropertyDescriptor(jt.prototype,"fovAxis"),jt.prototype),y(jt.prototype,"fov",[it,ot],Object.getOwnPropertyDescriptor(jt.prototype,"fov"),jt.prototype),y(jt.prototype,"orthoHeight",[at,nt],Object.getOwnPropertyDescriptor(jt.prototype,"orthoHeight"),jt.prototype),y(jt.prototype,"near",[ct,st],Object.getOwnPropertyDescriptor(jt.prototype,"near"),jt.prototype),y(jt.prototype,"far",[ht,pt],Object.getOwnPropertyDescriptor(jt.prototype,"far"),jt.prototype),y(jt.prototype,"aperture",[_t,ut,lt],Object.getOwnPropertyDescriptor(jt.prototype,"aperture"),jt.prototype),y(jt.prototype,"shutter",[ft,yt,mt],Object.getOwnPropertyDescriptor(jt.prototype,"shutter"),jt.prototype),y(jt.prototype,"iso",[gt,bt,dt],Object.getOwnPropertyDescriptor(jt.prototype,"iso"),jt.prototype),y(jt.prototype,"rect",[wt,Tt],Object.getOwnPropertyDescriptor(jt.prototype,"rect"),jt.prototype),y(jt.prototype,"targetTexture",[vt,Ot,xt],Object.getOwnPropertyDescriptor(jt.prototype,"targetTexture"),jt.prototype),St=jt))||St)||St)||St)||St));u.Camera=te}}}));
