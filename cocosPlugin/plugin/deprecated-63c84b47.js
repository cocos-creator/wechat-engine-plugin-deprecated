System.register(["./json-asset-1f2be75e.js","./index-a996f499.js","./view-368b93a3.js","./texture-buffer-pool-4d3e5972.js","./deprecated-c0e66301.js","./camera-component-4c08f67b.js","./renderable-component-da5e0106.js","./sprite-frame-9016d268.js","./sprite-dc4183cc.js","./renderable-2d-549948c8.js","./graphics-3f37ca15.js","./vertex-format-eb40922d.js","./deprecated-4eee0a13.js"],(function(t){"use strict";var e,i,n,r,s,o,a,h,l,c,u,p,f,_,d,y,g,m,b,v,C,x,S,A,T,D,O,E,w,I,L,R,B,F,M,k,P,z,H,j,W,N,U,G,X,V,Y,q,Z,Q,$,J,K,tt,et,it,nt,rt,st,ot,at,ht,lt,ct,ut,pt,ft,_t,dt,yt,gt,mt,bt;return{setters:[function(t){e=t.cc,i=t.c3,n=t.cK,r=t.ee,s=t.ej,o=t.eb,a=t.c_,h=t.cj,l=t.c5,c=t.dP,u=t.l,p=t.aq,f=t.z,_=t.G,d=t.dh,y=t.a3,g=t.e1,m=t.ef,b=t.gd,v=t.gm,C=t.gD,x=t.fY,S=t.g9,A=t.fZ,T=t.ei,D=t.fT,O=t.gn,E=t.ge,w=t.eg,I=t.ec,L=t.co,R=t.eh,B=t.t,F=t.fX,M=t.gB,k=t.dN,P=t.gy,z=t.gC,H=t.dG,j=t.d,W=t.gz,N=t.e3,U=t.aJ,G=t.dI,X=t.bO,V=t.et,Y=t.gE,q=t.eL},function(t){Z=t.d},function(t){Q=t.o,$=t.i},function(){},function(){},function(){},function(){},function(t){J=t.S},function(t){K=t.c,tt=t.H,et=t.F,it=t.b,nt=t.S,t.T,rt=t.a,st=t.f,ot=t.d,at=t.i,ht=t.e,lt=t.V},function(t){ct=t.a,ut=t.R,pt=t.I,ft=t.U},function(t){_t=t.G},function(t){dt=t.g,yt=t.a,gt=t.b,mt=t.c},function(t){bt=t.U}],execute:function(){var vt,Ct,xt,St,At,Tt,Dt,Ot,Et,wt,It,Lt,Rt,Bt,Ft,Mt,kt,Pt,zt,Ht,jt,Wt,Nt,Ut,Gt;t("e",void 0);var Xt,Vt=new e,Yt=new i,qt=new e,Zt=[];!function(t){t[t.RECT=0]="RECT",t[t.ELLIPSE=1]="ELLIPSE",t[t.GRAPHICS_STENCIL=2]="GRAPHICS_STENCIL",t[t.IMAGE_STENCIL=3]="IMAGE_STENCIL"}(Xt||(Xt=t("e",{}))),n(Xt);var Qt=t("a",(vt=r("cc.Mask"),Ct=x(),xt=S(110),St=A(),At=s(Xt),Tt=T(),Dt=D(),Ot=T(),Et=D(),wt=O(),It=s(J),Lt=O(),Rt=O(),Bt=E(),Ft=O(),Mt=O(),vt(kt=Ct(kt=xt(kt=St((Gt=Ut=function(t){function n(){var e;return(e=t.call(this)||this)._clearStencilMtl=null,e._clearModel=null,w(e,"_type",zt,I(e)),w(e,"_inverted",Ht,I(e)),w(e,"_segments",jt,I(e)),w(e,"_spriteFrame",Wt,I(e)),w(e,"_alphaThreshold",Nt,I(e)),e._graphics=null,e._clearModelMesh=null,e._instanceMaterialType=pt.ADD_COLOR,e}o(n,t);var r=n.prototype;return r.onLoad=function(){this._createClearModel(),this._createGraphics(),this._graphics&&this._graphics.onLoad()},r.onEnable=function(){t.prototype.onEnable.call(this),this._updateGraphics()},r.onRestore=function(){this._createGraphics(),t.prototype.updateMaterial.call(this),this._updateGraphics(),this._renderFlag=this._canRender()},r.onDisable=function(){t.prototype.onDisable.call(this),this._disableGraphics()},r.onDestroy=function(){t.prototype.onDestroy.call(this),this._clearModel&&this._clearModelMesh&&(Z.root.destroyModel(this._clearModel),this._clearModelMesh.destroy()),this._clearStencilMtl&&this._clearStencilMtl.destroy(),this._removeGraphics()},r.isHit=function(t){var n=this.node._uiProps.uiTransformComp,r=n.contentSize,s=r.width,o=r.height,a=Yt;this.node.getWorldMatrix(Vt),e.invert(qt,Vt),i.transformMat4(a,t,qt);var h=n.anchorPoint;a.x+=h.x*s,a.y+=h.y*o;var l=!1;if(this.type===Xt.RECT||this.type===Xt.GRAPHICS_STENCIL)l=a.x>=0&&a.y>=0&&a.x<=s&&a.y<=o;else if(this.type===Xt.ELLIPSE){var c=s/2,u=o/2,p=a.x-.5*s,f=a.y-.5*o;l=p*p/(c*c)+f*f/(u*u)<1}return this._inverted&&(l=!l),l},r._render=function(t){t.commitComp(this,null,this._assembler,null)},r._postRender=function(t){this._postAssembler&&t.commitComp(this,null,this._postAssembler,null)},r._nodeStateChange=function(e){t.prototype._nodeStateChange.call(this,e),this._updateGraphics()},r._canRender=function(){return!!t.prototype._canRender.call(this)&&null!==this._graphics&&(this._type!==Xt.IMAGE_STENCIL||null!==this._spriteFrame)},r._flushAssembler=function(){var t=n.Assembler.getAssembler(this),e=n.PostAssembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this._postAssembler!==e&&(this._postAssembler=e),this._useRenderData()},r._createGraphics=function(){if(!this._graphics){var t=this._graphics=new _t;t._objFlags|=a.Flags.IsOnLoadCalled,t.node=this.node,t.node.getWorldMatrix(),t.lineWidth=0;var e=h.WHITE.clone();e.a=0,t.fillColor=e}this._updateMaterial()},r._updateGraphics=function(){if(this._graphics&&(this._type===Xt.RECT||this._type===Xt.ELLIPSE)){var t=this.node._uiProps.uiTransformComp,e=this._graphics;e.clear();var i=t.contentSize,n=i.width,r=i.height,s=t.anchorPoint,o=-n*s.x,a=-r*s.y;if(this._type===Xt.RECT)e.rect(o,a,n,r);else if(this._type===Xt.ELLIPSE){for(var h=function(t,e,i){Zt.length=0;for(var n=2*Math.PI/i,r=0;r<i;++r)Zt.push(new l(e.x*Math.cos(n*r)+t.x,e.y*Math.sin(n*r)+t.y,0));return Zt}(new l(o+n/2,a+r/2,0),new l(n/2,r/2,0),this._segments),c=0;c<h.length;++c){var u=h[c];0===c?e.moveTo(u.x,u.y):e.lineTo(u.x,u.y)}e.close()}e.fill()}},r._createClearModel=function(){if(!this._clearModel){var t=c.get("default-clear-stencil");this._clearStencilMtl=new Q({parent:t,owner:this,subModelIdx:0}),this._clearModel=Z.root.createModel($),this._clearModel.node=this._clearModel.transform=this.node;var e=dt(yt),i=u.director.root.device,n=i.createBuffer(new p(f.VERTEX|f.TRANSFER_DST,_.DEVICE,4*e,e)),r=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]);n.update(r);var s=i.createBuffer(new p(f.INDEX|f.TRANSFER_DST,_.DEVICE,6*Uint16Array.BYTES_PER_ELEMENT,Uint16Array.BYTES_PER_ELEMENT)),o=new Uint16Array([0,1,2,2,1,3]);s.update(o),this._clearModelMesh=new d([n],yt,y.TRIANGLE_LIST,s),this._clearModelMesh.subMeshIdx=0,this._clearModel.initSubModel(0,this._clearModelMesh,this._clearStencilMtl)}},r._updateMaterial=function(){if(this._graphics){var t,e=this._graphics;e.stencilStage=ct.DISABLED,this._type===Xt.IMAGE_STENCIL?(t=c.get("ui-alpha-test-material"),e.setMaterial(t,0),(t=e.getMaterialInstance(0)).setProperty("alphaThreshold",this._alphaThreshold)):(t=c.get("ui-graphics-material"),e.setMaterial(t,0),e.getMaterialInstance(0))}},r._disableGraphics=function(){this._graphics&&this._graphics.onDisable()},r._removeGraphics=function(){this._graphics&&(this._graphics.destroy(),this._graphics._destroyImmediate(),this._graphics=null)},r._useRenderData=function(){this._type!==Xt.IMAGE_STENCIL||this._renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.markForUpdateRenderData())},g(n,[{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this.markForUpdateRenderData(!1),this._updateMaterial(),this._type!==Xt.IMAGE_STENCIL?(this._spriteFrame=null,this._updateGraphics(),this._renderData&&(this.destroyRenderData(),this._renderData=null)):(this._useRenderData(),this._graphics&&this._graphics.clear()))}},{key:"inverted",get:function(){return this._inverted},set:function(t){this._inverted=t,this.stencilStage=ct.DISABLED,this._graphics&&(this._graphics.stencilStage=ct.DISABLED)}},{key:"segments",get:function(){return this._segments},set:function(t){this._segments!==t&&(this._segments=L(t,3,1e4),this._updateGraphics())}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(this._spriteFrame!==t){var e=this._spriteFrame;this._spriteFrame=t,this._type===Xt.IMAGE_STENCIL&&!e&&t&&this.markForUpdateRenderData()}}},{key:"alphaThreshold",get:function(){return this._alphaThreshold},set:function(t){this._alphaThreshold!==t&&(this._alphaThreshold=t,this.type===Xt.IMAGE_STENCIL&&this._graphics&&this._graphics.getMaterialInstance(0).setProperty("alphaThreshold",this._alphaThreshold))}},{key:"graphics",get:function(){return this._graphics}},{key:"dstBlendFactor",get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor!==t&&(this._dstBlendFactor=t,this._updateBlendFunc())}},{key:"srcBlendFactor",get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor!==t&&(this._srcBlendFactor=t,this._updateBlendFunc())}},{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this.markForUpdateRenderData())}},{key:"customMaterial",get:function(){return this._customMaterial},set:function(){}}]),n}(ut),Ut.Type=Xt,m((Pt=Gt).prototype,"type",[At,Tt,Dt],Object.getOwnPropertyDescriptor(Pt.prototype,"type"),Pt.prototype),m(Pt.prototype,"inverted",[Ot,Et],Object.getOwnPropertyDescriptor(Pt.prototype,"inverted"),Pt.prototype),m(Pt.prototype,"segments",[wt],Object.getOwnPropertyDescriptor(Pt.prototype,"segments"),Pt.prototype),m(Pt.prototype,"spriteFrame",[It,Lt],Object.getOwnPropertyDescriptor(Pt.prototype,"spriteFrame"),Pt.prototype),m(Pt.prototype,"alphaThreshold",[Rt,Bt,b],Object.getOwnPropertyDescriptor(Pt.prototype,"alphaThreshold"),Pt.prototype),m(Pt.prototype,"color",[v,Ft],Object.getOwnPropertyDescriptor(Pt.prototype,"color"),Pt.prototype),m(Pt.prototype,"customMaterial",[v,Mt],Object.getOwnPropertyDescriptor(Pt.prototype,"customMaterial"),Pt.prototype),zt=m(Pt.prototype,"_type",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xt.RECT}}),Ht=m(Pt.prototype,"_inverted",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jt=m(Pt.prototype,"_segments",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 64}}),Wt=m(Pt.prototype,"_spriteFrame",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nt=m(Pt.prototype,"_alphaThreshold",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),kt=Pt))||kt)||kt)||kt)||kt));C._comp=Qt,u.Mask=Qt;var $t,Jt,Kt,te,ee,ie,ne,re,se,oe,ae,he,le,ce,ue,pe,fe,_e,de,ye,ge,me,be,ve,Ce,xe,Se,Ae,Te,De,Oe,Ee,we,Ie,Le,Re,Be,Fe,Me,ke,Pe,ze,He,je,We,Ne,Ue,Ge=/^(click)(\s)*=|(param)(\s)*=/,Xe=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/,Ve=t("H",function(){function t(){this._specialSymbolArray=[],this._stack=[],this._resultObjectArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])}var e=t.prototype;return e.parse=function(t){this._resultObjectArray.length=0,this._stack.length=0;for(var e=0,i=t.length;e<i;){var n=t.indexOf(">",e),r=-1;if(n>=0&&(r=t.lastIndexOf("<",n))<e-1&&(r=t.indexOf("<",n+1),n=t.indexOf(">",r+1)),r<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{var s=t.substring(e,r),o=t.substring(r+1,n);""===o&&(s=t.substring(e,n+1)),this._processResult(s),-1===n?n=r:"/"===t.charAt(r+1)?this._stack.pop():this._addToStack(o),e=n+1}}return this._resultObjectArray},e._attributeToObject=function(t){t=t.trim();var e={},i=/^(color|size)(\s)*=/.exec(t),n="",r=0,s="";if(i){if(n=i[0],""===(t=t.substring(n.length).trim()))return e;switch(r=t.indexOf(" "),n[0]){case"c":e.color=r>-1?t.substring(0,r).trim():t;break;case"s":e.size=parseInt(t)}return r>-1&&(s=t.substring(r+1).trim(),e.event=this._processEventHandler(s)),e}if((i=/^(br(\s)*\/)/.exec(t))&&i[0].length>0&&(n=i[0].trim()).startsWith("br")&&"/"===n[n.length-1])return e.isNewLine=!0,this._resultObjectArray.push({text:"",style:{isNewLine:!0}}),e;var o="";if((i=/^(img(\s)*src(\s)*=[^>]+\/)/.exec(t))&&i[0].length>0&&(n=i[0].trim()).startsWith("img")&&"/"===n[n.length-1]){var a;i=Xe.exec(t);for(var h=!1;i;){if(n=(t=t.substring(t.indexOf(i[0]))).substr(0,i[0].length),a=(r=(o=t.substring(n.length).trim()).indexOf(" "))>-1?o.substr(0,r):o,n=(n=n.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),t=o.substring(r).trim(),a.endsWith("/")&&(a=a.slice(0,-1)),"src"===n){switch(a.charCodeAt(0)){case 34:case 39:h=!0,a=a.slice(1,-1)}e.isImage=!0,e.src=a}else if("height"===n)e.imageHeight=parseInt(a);else if("width"===n)e.imageWidth=parseInt(a);else if("align"===n){switch(a.charCodeAt(0)){case 34:case 39:a=a.slice(1,-1)}e.imageAlign=a.toLowerCase()}else"offset"===n?e.imageOffset=a:"click"===n&&(e.event=this._processEventHandler(n+"="+a));e.event&&"param"===n&&(e.event[n]=a.replace(/^"|"$/g,"")),i=Xe.exec(t)}return h&&e.isImage&&this._resultObjectArray.push({text:"",style:e}),{}}if(i=/^(outline(\s)*[^>]*)/.exec(t)){var l={color:"#ffffff",width:1};if(t=i[0].substring("outline".length).trim()){var c,u=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(i=u.exec(t);i;)n=(t=t.substring(t.indexOf(i[0]))).substr(0,i[0].length),c=(r=(o=t.substring(n.length).trim()).indexOf(" "))>-1?o.substr(0,r):o,n=(n=n.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),t=o.substring(r).trim(),"click"===n?e.event=this._processEventHandler(n+"="+c):"color"===n?l.color=c:"width"===n&&(l.width=parseInt(c)),e.event&&"param"===n&&(e.event[n]=c.replace(/^"|"$/g,"")),i=u.exec(t)}e.outline=l}if((i=/^(on|u|b|i)(\s)*/.exec(t))&&i[0].length>0){switch(n=i[0],t=t.substring(n.length).trim(),n[0]){case"u":e.underline=!0;break;case"i":e.italic=!0;break;case"b":e.bold=!0}if(""===t)return e;e.event=this._processEventHandler(t)}return e},e._processEventHandler=function(t){for(var e={},i=0,n=!1,r=Ge.exec(t);r;){var s=r[0],o="";if(n=!1,'"'===(t=t.substring(s.length).trim()).charAt(0))(i=t.indexOf('"',1))>-1&&(o=t.substring(1,i).trim(),n=!0),i++;else if("'"===t.charAt(0))(i=t.indexOf("'",1))>-1&&(o=t.substring(1,i).trim(),n=!0),i++;else{var a=/(\S)+/.exec(t);i=(o=a?a[0]:"").length}n&&(e[s=s.substring(0,s.length-1).trim()]=o),t=t.substring(i).trim(),r=Ge.exec(t)}return e},e._addToStack=function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},e._processResult=function(t){0!==t.length&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},e._escapeSpecialSymbol=function(t){for(var e,i=B(this._specialSymbolArray);!(e=i()).done;){var n=e.value,r=n[0],s=n[1];t=t.replace(r,s)}return t},t}()),Ye=t("L",($t=r("cc.LabelOutline"),Jt=x(),Kt=S(110),te=A(),ee=M(K),ie=D(),ne=D(),$t(re=Jt(re=Kt(re=te(re=ee(re=F((he=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,w(e,"_color",oe,I(e)),w(e,"_width",ae,I(e)),e}o(e,t);var i=e.prototype;return i.onEnable=function(){this._updateRenderData()},i.onDisable=function(){this._updateRenderData()},i._updateRenderData=function(){var t=this.node.getComponent(K);t&&t.updateRenderData(!0)},g(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._updateRenderData())}}]),e}(k),oe=m((se=he).prototype,"_color",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new h(0,0,0,255)}}),ae=m(se.prototype,"_width",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),m(se.prototype,"color",[ie],Object.getOwnPropertyDescriptor(se.prototype,"color"),se.prototype),m(se.prototype,"width",[ne],Object.getOwnPropertyDescriptor(se.prototype,"width"),se.prototype),re=se))||re)||re)||re)||re)||re)||re)),qe=new Ve,Ze="RICHTEXT_CHILD",Qe="RICHTEXT_Image_CHILD",$e=new P((function(t){if(!u.isValid(t.node))return!1;var e=t.node.getComponent(Ye);return e&&(e.width=0),!0}),20),Je=new P((function(t){return u.isValid(t.node)}),10);function Ke(t){return{node:new H(t),comp:null,lineCount:0,styleIndex:0,imageOffset:"",clickParam:"",clickHandler:"",type:t}}function ti(t,e){var i;t===Ze?i=$e._get():t===Qe&&(i=Je._get());var n=(i=i||Ke(t)).node;return n||(n=new H(t)),n.hideFlags|=a.Flags.DontSave|a.Flags.HideInHierarchy,t===Qe?(i.comp=n.getComponent(rt)||n.addComponent(rt),i.comp.spriteFrame=e,i.comp.type=rt.Type.SLICED,i.comp.sizeMode=rt.SizeMode.CUSTOM):(i.comp=n.getComponent(K)||n.addComponent(K),i.comp.string=e,i.comp.horizontalAlign=tt.LEFT,i.comp.verticalAlign=lt.TOP),n.setPosition(0,0,0),n._uiProps.uiTransformComp.setAnchorPoint(.5,.5),i.node=n,i.lineCount=0,i.styleIndex=0,i.imageOffset="",i.clickParam="",i.clickHandler="",i}var ei,ii=t("R",(le=r("cc.RichText"),ce=x(),ue=S(110),pe=A(),fe=D(),_e=s(tt),de=D(),ye=D(),ge=D(),me=s(et),be=D(),ve=D(),Ce=s(it),xe=D(),Se=D(),Ae=D(),Te=s(nt),De=D(),Oe=D(),le(Ee=ce(Ee=ue(Ee=pe(Ee=F((Ue=Ne=function(t){function e(){var e;return e=t.call(this)||this,w(e,"_lineHeight",Ie,I(e)),w(e,"_string",Le,I(e)),w(e,"_horizontalAlign",Re,I(e)),w(e,"_fontSize",Be,I(e)),w(e,"_maxWidth",Fe,I(e)),w(e,"_fontFamily",Me,I(e)),w(e,"_font",ke,I(e)),w(e,"_isSystemFontUsed",Pe,I(e)),w(e,"_userDefinedFont",ze,I(e)),w(e,"_cacheMode",He,I(e)),w(e,"_imageAtlas",je,I(e)),w(e,"_handleTouchEvent",We,I(e)),e._textArray=[],e._segments=[],e._labelSegmentsCache=[],e._linesWidth=[],e._lineCount=1,e._labelWidth=0,e._labelHeight=0,e._layoutDirty=!0,e._lineOffsetX=0,e._updateRichTextStatus=void 0,e._updateRichTextStatus=e._updateRichText,e}o(e,t);var i=e.prototype;return i.onLoad=function(){this.node.on(z.LAYER_CHANGED,this._applyLayer,this)},i.onEnable=function(){this.handleTouchEvent&&this._addEventListeners(),this._updateRichText(),this._activateChildren(!0)},i.onDisable=function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},i.start=function(){this._onTTFLoaded(),this.node.on(z.ANCHOR_CHANGED,this._updateRichTextPosition,this)},i.onRestore=function(){},i.onDestroy=function(){for(var t,e=B(this._segments);!(t=e()).done;){var i=t.value;i.node.removeFromParent(),i.type===Ze?$e.put(i):i.type===Qe&&Je.put(i)}this.node.off(z.ANCHOR_CHANGED,this._updateRichTextPosition,this),this.node.off(z.LAYER_CHANGED,this._applyLayer,this)},i._addEventListeners=function(){this.node.on(z.TOUCH_END,this._onTouchEnded,this)},i._removeEventListeners=function(){this.node.off(z.TOUCH_END,this._onTouchEnded,this)},i._updateLabelSegmentTextAttributes=function(){var t=this;this._segments.forEach((function(e){t._applyTextAttribute(e)}))},i._createFontLabel=function(t){return ti(Ze,t)},i._createImage=function(t){return ti(Qe,t)},i._onTTFLoaded=function(){this._font,this._layoutDirty=!0,this._updateRichText()},i._measureText=function(t,e){var i=this,n=function(e){var n;return 0===i._labelSegmentsCache.length?(n=i._createFontLabel(e),i._labelSegmentsCache.push(n)):(n=i._labelSegmentsCache[0]).node.getComponent(K).string=e,n.styleIndex=t,i._applyTextAttribute(n),n.node._uiProps.uiTransformComp.contentSize.width};return e?n(e):n},i._onTouchEnded=function(t){for(var e,i=this,n=this.node.getComponents(k),r=function(){var r=e.value,s=r.clickHandler,o=r.clickParam;s&&i._containsTouchLocation(r,t.touch.getUILocation())&&(n.forEach((function(e){var i=e[s];e.enabledInHierarchy&&i&&i.call(e,t,o)})),t.propagationStopped=!0)},s=B(this._segments);!(e=s()).done;)r()},i._containsTouchLocation=function(t,e){var i=t.node.getComponent(ft);return!!i&&i.getBoundingBoxToWorld().contains(e)},i._resetState=function(){for(var t=this.node.children,e=t.length-1;e>=0;e--){var i=t[e];if(i.name===Ze||i.name===Qe){i.parent===this.node?i.parent=null:t.splice(e,1);var n=Ke(i.name);n.node=i,i.name===Ze?(n.comp=i.getComponent(K),$e.put(n)):(n.comp=i.getComponent(rt),Je.put(n))}}t.length=0,this._segments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},i._activateChildren=function(t){for(var e=this.node.children.length-1;e>=0;e--){var i=this.node.children[e];i.name!==Ze&&i.name!==Qe||(i.active=t)}},i._addLabelSegment=function(t,e){var i;if(0===this._labelSegmentsCache.length)i=this._createFontLabel(t);else{var n=(i=this._labelSegmentsCache.pop()).node.getComponent(K);n&&(n.string=t)}return i.styleIndex=e,i.lineCount=this._lineCount,i.node._uiProps.uiTransformComp.setAnchorPoint(0,0),i.node.layer=this.node.layer,this._applyTextAttribute(i),this.node.addChild(i.node),this._segments.push(i),i},i._updateRichTextWithMaxWidth=function(t,e,i){var n=e;if(this._lineOffsetX>0&&n+this._lineOffsetX>this._maxWidth)for(var r=0;this._lineOffsetX<=this._maxWidth;){var s=this._getFirstWordLen(t,r,t.length),o=t.substr(r,s),a=this._measureText(i,o);if(!(this._lineOffsetX+a<=this._maxWidth)){if(r>0){var h=t.substr(0,r);this._addLabelSegment(h,i),t=t.substr(r,t.length),n=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=a,r+=s}if(n>this._maxWidth)for(var l=st(t,n,this._maxWidth,this._measureText(i)),c=0;c<l.length;++c){var u=l[c],p=this._addLabelSegment(u,i).node._uiProps.uiTransformComp.contentSize;this._lineOffsetX+=p.width,l.length>1&&c<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=n,this._addLabelSegment(t,i)},i._isLastComponentCR=function(t){return t.length-1===t.lastIndexOf("\n")},i._updateLineInfo=function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},i._needsUpdateTextLayout=function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;e++){var i=this._textArray[e],n=t[e];if(i.text!==n.text)return!0;var r=i.style,s=n.style;if(r){if(s){if(!!s.outline!=!!r.outline)return!0;if(r.size!==s.size||r.italic!==s.italic||r.isImage!==s.isImage)return!0;if(r.src!==s.src||r.imageAlign!==s.imageAlign||r.imageHeight!==s.imageHeight||r.imageWidth!==s.imageWidth||r.imageOffset!==s.imageOffset)return!0}else if(r.size||r.italic||r.isImage||r.outline)return!0}else if(s&&(s.size||s.italic||s.isImage||s.outline))return!0}return!1},i._addRichTextImageElement=function(t){if(t.style){var e=t.style,i=e.src,n=this._imageAtlas&&i&&this._imageAtlas.getSpriteFrame(i);if(n){var r=this._createImage(n);switch(r.comp,e.imageAlign){case"top":r.node._uiProps.uiTransformComp.setAnchorPoint(0,1);break;case"center":r.node._uiProps.uiTransformComp.setAnchorPoint(0,.5);break;default:r.node._uiProps.uiTransformComp.setAnchorPoint(0,0)}r.node.layer=this.node.layer,this.node.addChild(r.node),this._segments.push(r);var s=n.rect.clone(),o=1,a=s.width,h=s.height,l=e.imageWidth||0,c=e.imageHeight||0;c>0?(a*=o=c/h,h*=o):(a*=o=this._lineHeight/h,h*=o),l>0&&(a=l),this._maxWidth>0?(this._lineOffsetX+a>this._maxWidth&&this._updateLineInfo(),this._lineOffsetX+=a):(this._lineOffsetX+=a,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),r.node._uiProps.uiTransformComp.setContentSize(a,h),r.lineCount=this._lineCount,r.clickHandler="",r.clickParam="";var u=e.event;u&&(r.clickHandler=u.click,r.clickParam=u.param)}else j(4400)}},i._updateRichText=function(){if(this.enabledInHierarchy){var t=qe.parse(this._string);if(!this._needsUpdateTextLayout(t))return this._textArray=t.slice(),void this._updateLabelSegmentTextAttributes();this._textArray=t.slice(),this._resetState();for(var e,i=!1,n=0;n<this._textArray.length;++n){var r=this._textArray[n],s=r.text;if(void 0!==s){if(""===s){if(r.style&&r.style.isNewLine){this._updateLineInfo();continue}if(r.style&&r.style.isImage&&this._imageAtlas){this._addRichTextImageElement(r);continue}}for(var o=s.split("\n"),a=0;a<o.length;++a){var h=o[a];if(""!==h)if(i=!1,this._maxWidth>0){var l=this._measureText(n,h);this._updateRichTextWithMaxWidth(h,l,n),o.length>1&&a<o.length-1&&this._updateLineInfo()}else e=this._addLabelSegment(h,n),this._lineOffsetX+=e.node._uiProps.uiTransformComp.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),o.length>1&&a<o.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(s)&&a===o.length-1)continue;this._updateLineInfo(),i=!0}}}}i||this._linesWidth.push(this._lineOffsetX),this._maxWidth>0&&(this._labelWidth=this._maxWidth),this._labelHeight=(this._lineCount+ot)*this._lineHeight,this.node._uiProps.uiTransformComp.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},i._getFirstWordLen=function(t,e,i){var n=t.charAt(e);if(at(n)||ht(n))return 1;for(var r=1,s=e+1;s<i&&(n=t.charAt(s),!ht(n)&&!at(n));++s)r++;return r},i._updateRichTextPosition=function(){for(var t=0,e=1,i=this._lineCount,n=this.node._uiProps.uiTransformComp,r=n.anchorX,s=n.anchorY,o=0;o<this._segments.length;++o){var a=this._segments[o],h=a.lineCount;h>e&&(t=0,e=h);var l=this._labelWidth*(.5*this._horizontalAlign-r);switch(this._horizontalAlign){case tt.LEFT:break;case tt.CENTER:l-=this._linesWidth[h-1]/2;break;case tt.RIGHT:l-=this._linesWidth[h-1]}var c=a.node.position;if(a.node.setPosition(t+l,this._lineHeight*(i-h)-this._labelHeight*s,c.z),h===e&&(t+=a.node._uiProps.uiTransformComp.width),a.node.getComponent(rt)){var u=a.node.position.clone(),p=this._lineHeight,f=this._lineHeight*(1+ot);switch(a.node._uiProps.uiTransformComp.anchorY){case 1:u.y+=p+(f-p)/2;break;case.5:u.y+=f/2;break;default:u.y+=(f-p)/2}if(a.imageOffset){var _=a.imageOffset.split(",");if(1===_.length&&_[0]){var d=parseFloat(_[0]);Number.isInteger(d)&&(u.y+=d)}else if(2===_.length){var y=parseFloat(_[0]),g=parseFloat(_[1]);Number.isInteger(y)&&(u.x+=y),Number.isInteger(g)&&(u.y+=g)}}a.node.position=u}var m=a.node.getComponent(Ye);if(m){var b=a.node.position.clone();b.y-=m.width,a.node.position=b}}},i._convertLiteralColorValue=function(t){var e=t.toUpperCase();return h[e]?h[e]:(new h).fromHEX(t)},i._applyTextAttribute=function(t){var e=t.node.getComponent(K);if(e){var i,n=t.styleIndex;if(this._textArray[n]&&(i=this._textArray[n].style),i){if(e.color=this._convertLiteralColorValue(i.color||"white"),e.isBold=!!i.bold,e.isItalic=!!i.italic,e.isUnderline=!!i.underline,i.outline){var r=t.node.getComponent(Ye);r||(r=t.node.addComponent(Ye)),r.color=this._convertLiteralColorValue(i.outline.color),r.width=i.outline.width}e.fontSize=i.size||this._fontSize,t.clickHandler="",t.clickParam="";var s=i.event;s&&(t.clickHandler=s.click||"",t.clickParam=s.param||"")}else e.fontSize=this._fontSize;e.cacheMode=this._cacheMode,this._font instanceof et&&!this._isSystemFontUsed?e.font=this._font:e.fontFamily=this._fontFamily,e.useSystemFont=this._isSystemFontUsed,e.lineHeight=this._lineHeight,e.updateRenderData(!0);var o=e._assembler;o&&o.updateRenderData(e)}},i._applyLayer=function(){for(var t,e=B(this._segments);!(t=e()).done;)t.value.node.layer=this.node.layer},g(e,[{key:"string",get:function(){return this._string},set:function(t){this._string!==t&&(this._string=t,this._updateRichTextStatus())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this.horizontalAlign!==t&&(this._horizontalAlign=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this._layoutDirty=!0,this._font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},{key:"useSystemFont",get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this._isSystemFontUsed=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"cacheMode",get:function(){return this._cacheMode},set:function(t){this._cacheMode!==t&&(this._cacheMode=t,this._updateRichTextStatus())}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"imageAtlas",get:function(){return this._imageAtlas},set:function(t){this._imageAtlas!==t&&(this._imageAtlas=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"handleTouchEvent",get:function(){return this._handleTouchEvent},set:function(t){this._handleTouchEvent!==t&&(this._handleTouchEvent=t,this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners()))}}]),e}(bt),Ne.HorizontalAlign=tt,Ne.VerticalAlign=lt,m((we=Ue).prototype,"string",[W,fe],Object.getOwnPropertyDescriptor(we.prototype,"string"),we.prototype),m(we.prototype,"horizontalAlign",[_e,de],Object.getOwnPropertyDescriptor(we.prototype,"horizontalAlign"),we.prototype),m(we.prototype,"fontSize",[ye],Object.getOwnPropertyDescriptor(we.prototype,"fontSize"),we.prototype),m(we.prototype,"fontFamily",[ge],Object.getOwnPropertyDescriptor(we.prototype,"fontFamily"),we.prototype),m(we.prototype,"font",[me,be],Object.getOwnPropertyDescriptor(we.prototype,"font"),we.prototype),m(we.prototype,"useSystemFont",[ve],Object.getOwnPropertyDescriptor(we.prototype,"useSystemFont"),we.prototype),m(we.prototype,"cacheMode",[Ce,xe],Object.getOwnPropertyDescriptor(we.prototype,"cacheMode"),we.prototype),m(we.prototype,"maxWidth",[Se],Object.getOwnPropertyDescriptor(we.prototype,"maxWidth"),we.prototype),m(we.prototype,"lineHeight",[Ae],Object.getOwnPropertyDescriptor(we.prototype,"lineHeight"),we.prototype),m(we.prototype,"imageAtlas",[Te,De],Object.getOwnPropertyDescriptor(we.prototype,"imageAtlas"),we.prototype),m(we.prototype,"handleTouchEvent",[Oe],Object.getOwnPropertyDescriptor(we.prototype,"handleTouchEvent"),we.prototype),Ie=m(we.prototype,"_lineHeight",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Le=m(we.prototype,"_string",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"<color=#00ff00>Rich</color><color=#0fffff>Text</color>"}}),Re=m(we.prototype,"_horizontalAlign",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return tt.LEFT}}),Be=m(we.prototype,"_fontSize",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Fe=m(we.prototype,"_maxWidth",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Me=m(we.prototype,"_fontFamily",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Arial"}}),ke=m(we.prototype,"_font",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=m(we.prototype,"_isSystemFontUsed",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ze=m(we.prototype,"_userDefinedFont",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=m(we.prototype,"_cacheMode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return it.NONE}}),je=m(we.prototype,"_imageAtlas",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=m(we.prototype,"_handleTouchEvent",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ee=we))||Ee)||Ee)||Ee)||Ee)||Ee)),ni=t("U",r("cc.UIMeshRenderer")(ei=x()(ei=S(110)(ei=A()(ei=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._models=null,e._modelComponent=null,e}o(e,t);var i=e.prototype;return i.onLoad=function(){this.node._uiProps.uiTransformComp||this.node.addComponent("cc.UITransform"),this._modelComponent=this.getComponent("cc.RenderableComponent"),this._modelComponent?this._models=this._modelComponent._collectModels():console.warn("node '"+(this.node&&this.node.name)+"' doesn't have any renderable component")},i.onEnable=function(){t.prototype.onEnable.call(this)},i.onDisable=function(){t.prototype.onDisable.call(this)},i.onDestroy=function(){t.prototype.onDestroy.call(this),this._modelComponent=this.getComponent("cc.RenderableComponent"),this._modelComponent&&(this._modelComponent._sceneGetter=null,this._models=null)},i.updateAssembler=function(t){if(this._models){this._modelComponent._detachFromScene();for(var e,i=B(this._models);!(e=i()).done;){var n=e.value;t.commitModel.call(t,this,n,this._modelComponent.material)}return!0}return!1},i.update=function(){this._fitUIRenderQueue()},i._fitUIRenderQueue=function(){if(this._modelComponent)for(var t=this._modelComponent.sharedMaterials.length,e=0;e<t;e++){var i=this._modelComponent.getMaterialInstance(e);if(null!=i)for(var n=i.passes,r=n.length,s=0;s<r;s++){var o=n[s];o._priority=N.MAX-11,o.blendState.targets[0].blend||i.overridePipelineStates({blendState:{targets:[{blend:!0}]}},s)}}},g(e,[{key:"modelComponent",get:function(){return this._modelComponent}}]),e}(bt))||ei)||ei)||ei)||ei),ri=t("M",function(){function t(t){this.vData=null,this.iData=null,this.byteStart=0,this.byteOffset=0,this.indicesStart=0,this.indicesOffset=0,this.vertexStart=0,this.vertexOffset=0,this.lastByteOffset=1,this._attributes=null,this._vertexBuffers=[],this._indexBuffer=null,this._iaInfo=null,this._batcher=void 0,this._dirty=!1,this._vertexFormatBytes=0,this._initVDataCount=0,this._initIDataCount=1536,this._outOfCallback=null,this._hInputAssemblers=[],this._nextFreeIAHandle=0,this._batcher=t}var e=t.prototype;return e.initialize=function(t,e){this._outOfCallback=e;var i=gt(t);this._vertexFormatBytes=i*Float32Array.BYTES_PER_ELEMENT,this._initVDataCount=256*this._vertexFormatBytes;var n=Float32Array.BYTES_PER_ELEMENT*i;this.vertexBuffers.length||this.vertexBuffers.push(this._batcher.device.createBuffer(new p(f.VERTEX|f.TRANSFER_DST,_.HOST|_.DEVICE,n,n)));var r=Uint16Array.BYTES_PER_ELEMENT;this.indexBuffer||(this._indexBuffer=this._batcher.device.createBuffer(new p(f.INDEX|f.TRANSFER_DST,_.HOST|_.DEVICE,r,r))),this._attributes=t,this._iaInfo=new U(this.attributes,this.vertexBuffers,this.indexBuffer),this.vData&&this.iData||this._reallocBuffer()},e.request=function(t,e){void 0===t&&(t=4),void 0===e&&(e=6),this.lastByteOffset=this.byteOffset;var i=this.byteOffset+t*this._vertexFormatBytes,n=this.indicesOffset+e;if(t+this.vertexOffset>65535)return this._outOfCallback&&this._outOfCallback.call(this._batcher,t,e),!1;var r=this.vData.byteLength,s=this.iData.length;if(i>r||n>s){for(;r<i||s<n;)this._initVDataCount*=2,this._initIDataCount*=2,r=4*this._initVDataCount,s=this._initIDataCount;this._reallocBuffer()}return this.vertexOffset+=t,this.indicesOffset+=e,this.byteOffset=i,this._dirty=!0,!0},e.reset=function(){this.byteStart=0,this.byteOffset=0,this.indicesStart=0,this.indicesOffset=0,this.vertexStart=0,this.vertexOffset=0,this.lastByteOffset=0,this._nextFreeIAHandle=0,this._dirty=!1},e.destroy=function(){this._attributes=null,this.vertexBuffers[0].destroy(),this.vertexBuffers.length=0,this.indexBuffer.destroy(),this._indexBuffer=null;for(var t=0;t<this._hInputAssemblers.length;t++)this._hInputAssemblers[t].destroy();this._hInputAssemblers.length=0},e.recordBatch=function(){var t=this.indicesOffset-this.indicesStart;if(!t)return null;this._hInputAssemblers.length<=this._nextFreeIAHandle&&this._hInputAssemblers.push(this._batcher.device.createInputAssembler(this._iaInfo));var e=this._hInputAssemblers[this._nextFreeIAHandle++];return e.firstIndex=this.indicesStart,e.indexCount=t,e},e.uploadBuffers=function(){if(0!==this.byteOffset&&this._dirty){var t=new Float32Array(this.vData.buffer,0,this.byteOffset>>2),e=new Uint16Array(this.iData.buffer,0,this.indicesOffset);this.byteOffset>this.vertexBuffers[0].size&&this.vertexBuffers[0].resize(this.byteOffset),this.vertexBuffers[0].update(t),2*this.indicesOffset>this.indexBuffer.size&&this.indexBuffer.resize(2*this.indicesOffset),this.indexBuffer.update(e),this._dirty=!1}},e._reallocBuffer=function(){this._reallocVData(!0),this._reallocIData(!0)},e._reallocVData=function(t){var e;if(this.vData&&(e=new Uint8Array(this.vData.buffer)),this.vData=new Float32Array(this._initVDataCount),e&&t)for(var i=new Uint8Array(this.vData.buffer),n=0,r=e.length;n<r;n++)i[n]=e[n]},e._reallocIData=function(t){var e=this.iData;if(this.iData=new Uint16Array(this._initIDataCount),e&&t)for(var i=this.iData,n=0,r=e.length;n<r;n++)i[n]=e[n]},g(t,[{key:"attributes",get:function(){return this._attributes}},{key:"vertexBuffers",get:function(){return this._vertexBuffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"vertexFormatBytes",get:function(){return this._vertexFormatBytes}}]),t}());ri.OPACITY_OFFSET=8;var si,oi,ai,hi,li,ci,ui,pi,fi,_i,di,yi,gi,mi,bi,vi,Ci,xi,Si,Ai,Ti,Di,Oi,Ei,wi,Ii,Li=G.Enum.NONE|G.Enum.UI_3D,Ri=t("D",function(){function t(){this.bufferBatch=null,this.camera=null,this.renderScene=null,this.model=null,this.texture=null,this.sampler=null,this.useLocalData=null,this.isStatic=!1,this.textureHash=0,this.samplerHash=0,this._passes=[],this._shaders=[],this._visFlags=Li,this._inputAssember=null,this._descriptorSet=null}var e=t.prototype;return e.destroy=function(){this._passes=[]},e.clear=function(){this.bufferBatch=null,this.inputAssembler=null,this.descriptorSet=null,this.camera=null,this.texture=null,this.sampler=null,this.model=null,this.isStatic=!1,this.useLocalData=null,this.visFlags=Li,this.renderScene=null},e.fillPasses=function(t,e,i,n,r,s){if(t){var o=t.passes;if(!o)return;var a=0;this._shaders.length=o.length;for(var h=0;h<o.length;h++){this._passes[h]||(this._passes[h]=new X(u.director.root));var l=o[h],c=this._passes[h];l.update(),e||(e=l.depthStencilState,i=0),n||(n=l.blendState,r=0),-1===r&&(r=0),a=i<<16|r,c._initPassFromTarget(l,e,n,a),this._shaders[h]=c.getShaderVariant(s)}}},g(t,[{key:"native",get:function(){return this._nativeObj}},{key:"inputAssembler",get:function(){return this._inputAssember},set:function(t){this._inputAssember=t}},{key:"descriptorSet",get:function(){return this._descriptorSet},set:function(t){this._descriptorSet=t}},{key:"visFlags",get:function(){return this._visFlags},set:function(t){this._visFlags=t}},{key:"passes",get:function(){return this._passes}},{key:"shaders",get:function(){return this._shaders}}]),t}()),Bi=t("b",(si=r("cc.UIStaticBatch"),oi=x(),ai=A(),hi=S(110),li=O(),si(ci=oi(ci=ai(ci=hi((pi=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._init=!1,e._meshBuffer=null,e._dirty=!0,e._lastMeshBuffer=null,e._uiDrawBatchList=[],e}o(e,t);var i=e.prototype;return i.onLoad=function(){var t=this._getBatcher();if(t){var e=mt,i=new ri(t);i.initialize(e,this._arrivalMaxBuffer.bind(this)),this._meshBuffer=i}},i.onDestroy=function(){t.prototype.onDestroy.call(this),this._clearData(),this._meshBuffer&&(this._meshBuffer.destroy(),this._meshBuffer=null)},i.updateAssembler=function(t){t.currIsStatic=!0,this._dirty&&(t.finishMergeBatches(),this._lastMeshBuffer=t.currBufferBatch,t.currBufferBatch=this._meshBuffer,t.currStaticRoot=this),this._init&&(t.finishMergeBatches(),t.commitStaticBatch(this))},i.postUpdateAssembler=function(t){this._dirty&&(t.finishMergeBatches(),t.currBufferBatch=this._lastMeshBuffer,t.currStaticRoot=null,this._dirty=!1,this._init=!0,this.node._static=!0,this._meshBuffer.uploadBuffers()),t.currIsStatic=!1},i.markAsDirty=function(){this._getBatcher()&&(this.node._static=!1,this._dirty=!0,this._init=!1,this._clearData())},i._requireDrawBatch=function(){var t=new Ri;return t.isStatic=!0,this._uiDrawBatchList.push(t),t},i._clearData=function(){if(this._meshBuffer){this._meshBuffer.reset();for(var t=this._getBatcher(),e=0;e<this._uiDrawBatchList.length;e++)this._uiDrawBatchList[e].destroy(t)}this._uiDrawBatchList.length=0,this._init=!1},i._getBatcher=function(){return Z.root&&Z.root.batcher2D?Z.root.batcher2D:(j(9301),null)},i._arrivalMaxBuffer=function(){var t=this._getBatcher();t&&t.autoMergeBatches(),j(9300)},g(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&this._color.set(t)}},{key:"drawBatchList",get:function(){return this._uiDrawBatchList}}]),e}(ut),m((ui=pi).prototype,"color",[v,li],Object.getOwnPropertyDescriptor(ui.prototype,"color"),ui.prototype),ci=ui))||ci)||ci)||ci)||ci)),Fi=(t("c",(fi=r("cc.LabelShadow"),_i=x(),di=S(110),yi=A(),gi=M(K),mi=D(),bi=D(),vi=D(),fi(Ci=_i(Ci=di(Ci=yi(Ci=gi(Ci=F((Di=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,w(e,"_color",Si,I(e)),w(e,"_offset",Ai,I(e)),w(e,"_blur",Ti,I(e)),e}o(e,t);var i=e.prototype;return i.onEnable=function(){this._updateRenderData()},i.onDisable=function(){this._updateRenderData()},i._updateRenderData=function(){var t=this.node.getComponent(K);t&&t.updateRenderData(!0)},g(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t,this._updateRenderData()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._updateRenderData()}}]),e}(k),Si=m((xi=Di).prototype,"_color",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new h(0,0,0,255)}}),Ai=m(xi.prototype,"_offset",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new i(2,2)}}),Ti=m(xi.prototype,"_blur",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),m(xi.prototype,"color",[mi],Object.getOwnPropertyDescriptor(xi.prototype,"color"),xi.prototype),m(xi.prototype,"offset",[bi],Object.getOwnPropertyDescriptor(xi.prototype,"offset"),xi.prototype),m(xi.prototype,"blur",[vi],Object.getOwnPropertyDescriptor(xi.prototype,"blur"),xi.prototype),Ci=xi))||Ci)||Ci)||Ci)||Ci)||Ci)||Ci)),t("d",r("cc.UIOpacity")(Oi=x()(Oi=S(110)(Oi=A()(Oi=F((Ii=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,w(e,"_opacity",wi,I(e)),e}o(e,t);var i=e.prototype;return i.onEnable=function(){this.node._uiProps.localOpacity=this._opacity/255},i.onDisable=function(){this.node._uiProps.localOpacity=1},g(e,[{key:"opacity",get:function(){return this._opacity},set:function(t){this._opacity!==t&&(t=Y(t,0,255),this._opacity=t,this.node._uiProps.localOpacity=t/255)}}]),e}(k),m((Ei=Ii).prototype,"opacity",[V],Object.getOwnPropertyDescriptor(Ei.prototype,"opacity"),Ei.prototype),wi=m(Ei.prototype,"_opacity",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),Oi=Ei))||Oi)||Oi)||Oi)||Oi)||Oi));u.MaskComponent=Qt,q.setClassAlias(Qt,"cc.MaskComponent"),u.LabelComponent=K,q.setClassAlias(K,"cc.LabelComponent"),u.LabelOutlineComponent=Ye,q.setClassAlias(Ye,"cc.LabelOutlineComponent"),u.RichTextComponent=ii,q.setClassAlias(ii,"cc.RichTextComponent"),u.SpriteComponent=rt,q.setClassAlias(rt,"cc.SpriteComponent"),u.UIModelComponent=ni,q.setClassAlias(ni,"cc.UIModelComponent"),u.GraphicsComponent=_t,q.setClassAlias(_t,"cc.GraphicsComponent"),q.setClassAlias(Bi,"cc.UIStaticBatchComponent"),q.setClassAlias(Fi,"cc.UIOpacityComponent")}}}));
