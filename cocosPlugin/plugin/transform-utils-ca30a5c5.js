System.register(["./json-asset-1f2be75e.js","./view-368b93a3.js","./deprecated-c0e66301.js"],(function(t){"use strict";var e,n,i,r,a,s,o,u,h,c,l,f,p,_,v,d,m,g,y,w,T,b,A,S,E,C,k,I,P,x,O,N,M,L,R,z,F,V,D,U,B,W,Q,H,j,q,K,G,Y,X,J,Z,$,tt,et,nt,it;return{setters:[function(t){e=t.ee,n=t.dG,i=t.d,r=t.ef,a=t.eg,s=t.eh,o=t.l,u=t.c9,h=t.c3,c=t.c5,l=t.c7,f=t.eL,p=t.f$,_=t.e1,v=t.g0,d=t.f,m=t.t,g=t.eb,y=t.ec,w=t.dT,T=t.dX,b=t.cj,A=t.cf,S=t.dZ,E=t.dQ,C=t.dS,k=t.g1,I=t.cq,P=t.cL,x=t.g2,O=t.dy,N=t.g3,M=t.dU,L=t.dW,R=t.dY,z=t.co,F=t.cc,V=t.fh,D=t.de,U=t.g4,B=t.cU,W=t.g5,Q=t.cK,H=t.g6,j=t.dv,q=t.cp,K=t.g7,G=t.ej,Y=t.fX,X=t.ff,J=t.g8,Z=t.dd,$=t.fY,tt=t.g9,et=t.fZ,nt=t.fT,it=t.dN},function(){},function(){}],execute:function(){var rt,at,st,ot,ut,ht,ct,lt;function ft(t){return"string"==typeof t||"number"==typeof t}t({b:function(t,e){return t instanceof e},i:ft,n:Be,o:function(t,e){for(var n=t,i="";null!==n&&n!==e;)i=n.name+"/"+i,n=n.parent;return i.slice(0,-1)},p:function(t,e,n){for(F.identity(n);t!==e;)F.fromRTS($i,t.rotation,t.position,t.scale),F.multiply(n,$i,n),t=t.parent;return n},q:function(t,e){for(var n=0,i=F.IDENTITY;t;){if(t.stamp===e||t.stamp+1===e&&!t.node.hasChangedFlags){i=t.world,t.stamp=e;break}t.stamp=e,Ji[n++]=t,t=t.parent}for(;n>0;){t=Ji[--n],Ji[n]=null;var r=t.node;F.fromRTS(t.local,r.rotation,r.position,r.scale),i=F.multiply(t.world,i,t.local)}return i},r:function(t){for(var e=Zi.get(t.uuid)||null;e;)Zi.delete(e.node.uuid),e=e.parent},s:Ue,t:function(t,e){for(var n,i=null,r=0;t!==e;){var a=t.uuid;if(Zi.has(a)){i=Zi.get(a);break}i={node:t,local:new F,world:new F,stamp:-1,parent:null},Zi.set(a,i),Ji[r++]=i,t=t.parent,i=null}for(;r>0;)n=Ji[--r],Ji[r]=null,n.parent=i,i=n;return i}});var pt,_t,vt,dt,mt,gt,yt=t("H",e("cc.animation.HierarchyPath")((ot=function(){function t(t){a(this,"path",st,this),this.path=t||""}return t.prototype.get=function(t){return t instanceof n?t.getChildByPath(this.path)||(i(3926,t.name,this.path),null):(i(3925),null)},t}(),st=r((at=ot).prototype,"path",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),rt=at))||rt),wt=t("c",e("cc.animation.ComponentPath")((lt=function(){function t(t){a(this,"component",ct,this),this.component=t||""}return t.prototype.get=function(t){return t instanceof n?t.getComponent(this.component)||(i(3928,t.name,this.component),null):(i(3927),null)},t}(),ct=r((ht=lt).prototype,"component",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ut=ht))||ut);function Tt(t,n,i,o){var h,c,l,f,p,_,v=new n,d=new n,m=new n,g=e(t)((_=function(){function t(t,e,i){a(this,"dataPoint",l,this),a(this,"inTangent",f,this),a(this,"outTangent",p,this),this.dataPoint=t||new n,this.inTangent=e||new n,this.outTangent=i||new n}var e=t.prototype;return e.lerp=function(t,e,n){var r=this.dataPoint,a=t.dataPoint;d=i(d,this.inTangent,n),m=i(m,t.outTangent,n);var s=e*e*e,u=e*e,h=s-2*u+e,c=-2*s+3*u,l=s-u;return v=i(v,r,2*s-3*u+1),v=o(v,v,d,h),v=o(v,v,a,c),v=o(v,v,m,l)},e.getNoLerp=function(){return this.dataPoint},t}(),l=r((c=_).prototype,"dataPoint",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n}}),f=r(c.prototype,"inTangent",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n}}),p=r(c.prototype,"outTangent",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new n}}),h=c))||h;if(n===u){var y=g.prototype.lerp;g.prototype.lerp=function(t,e,n){var i=y.call(this,t,e,n);return u.normalize(i,i),i}}return g}var bt=t("d",Tt("cc.CubicSplineVec2Value",h,h.multiplyScalar,h.scaleAndAdd));o.CubicSplineVec2Value=bt;var At=t("e",Tt("cc.CubicSplineVec3Value",c,c.multiplyScalar,c.scaleAndAdd));o.CubicSplineVec3Value=At;var St=t("f",Tt("cc.CubicSplineVec4Value",l,l.multiplyScalar,l.scaleAndAdd));o.CubicSplineVec4Value=St;var Et=t("g",Tt("cc.CubicSplineQuatValue",u,u.multiplyScalar,u.scaleAndAdd));o.CubicSplineQuatValue=Et;var Ct=t("h",e("cc.CubicSplineNumberValue")((gt=function(){function t(t,e,n){a(this,"dataPoint",vt,this),a(this,"inTangent",dt,this),a(this,"outTangent",mt,this),this.dataPoint=t,this.inTangent=e,this.outTangent=n}var e=t.prototype;return e.lerp=function(t,e,n){var i=this.dataPoint,r=t.dataPoint,a=e*e*e,s=e*e;return i*(2*a-3*s+1)+this.outTangent*n*(a-2*s+e)+r*(-2*a+3*s)+t.inTangent*n*(a-s)},e.getNoLerp=function(){return this.dataPoint},t}(),vt=r((_t=gt).prototype,"dataPoint",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dt=r(_t.prototype,"inTangent",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),mt=r(_t.prototype,"outTangent",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=_t))||pt);o.CubicSplineNumberValue=Ct;var kt,It,Pt,xt,Ot,Nt,Mt,Lt,Rt,zt,Ft,Vt,Dt,Ut,Bt,Wt,Qt,Ht,jt,qt,Kt,Gt,Yt,Xt,Jt,Zt,$t,te=Symbol("CreateEval"),ee=Symbol("NormalizedFollow"),ne=Symbol("ConvertAsTrsPath"),ie=Symbol("TrackBinding"),re=t("a",e("cc.animation.TrackPath")((xt=function(){function t(){a(this,"_paths",Pt,this)}var e=t.prototype;return e.toProperty=function(t){return this._paths.push(t),this},e.toElement=function(t){return this._paths.push(t),this},e.toHierarchy=function(t){return this._paths.push(new yt(t)),this},e.toComponent=function(t){var e=new wt("string"==typeof t?t:f.getClassName(t));return this._paths.push(e),this},e.toCustomized=function(t){return this._paths.push(t),this},e.append=function(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=(t=this._paths).concat.apply(t,n.map((function(t){return t._paths})));return this._paths=r,this},e.isPropertyAt=function(t){return"string"==typeof this._paths[t]},e.parsePropertyAt=function(t){return this._paths[t]},e.isElementAt=function(t){return"number"==typeof this._paths[t]},e.parseElementAt=function(t){return this._paths[t]},e.isHierarchyAt=function(t){return this._paths[t]instanceof yt},e.parseHierarchyAt=function(t){return p(this.isHierarchyAt(t)),this._paths[t].path},e.isComponentAt=function(t){return this._paths[t]instanceof wt},e.parseComponentAt=function(t){return p(this.isComponentAt(t)),this._paths[t].component},e.slice=function(e,n){var i=new t;return i._paths=this._paths.slice(e,n),i},e.trace=function(t,e,n){var i,r;return null!==(i=e)&&void 0!==i||(e=0),null!==(r=n)&&void 0!==r||(n=this._paths.length),this[ee](t,e,n)},e[ne]=function(){for(var t,e=this._paths,n=e.length,i=0,r="";i<n;++i){var a=e[i];if(!(a instanceof yt))break;a.path&&(r?r+="/"+a.path:r=a.path)}if(i===n)return null;if(i!==n-1)return null;switch(e[i]){case"position":case"scale":case"rotation":case"eulerAngles":t=e[i];break;default:return null}return{node:r,property:t}},e[ee]=function(t,e,n){for(var r=this._paths,a=t,s=e;s<n;++s){var o=r[s];if(ft(o)){if(!(o in a))return i(3929,o),null;a=a[o]}else a=o.get(a);if(null===a)break}return a},_(t,[{key:"length",get:function(){return this._paths.length}}]),t}(),Pt=r((It=xt).prototype,"_paths",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kt=It))||kt),ae=e("cc.animation.TrackBinding")(Ot=v((Rt=function(){function t(){a(this,"path",Mt,this),a(this,"proxy",Lt,this)}var e=t.prototype;return e.parseTrsPath=function(){return this.proxy?null:this.path[ne]()},e.createRuntimeBinding=function(t,e,i){var r=this.path,a=this.proxy,s=r.length,o=s-1;if(0===s||!r.isPropertyAt(o)&&!r.isElementAt(o)||a){if(a){var u=r[ee](t,0,s);if(null===u)return null;var h=a.forTarget(u),c={setValue:function(t){h.set(t)}},l=h.get;return l&&(c.getValue=function(){return l.call(h)}),c}return d(3921),null}var f,p=r.isPropertyAt(o)?r.parsePropertyAt(o):r.parseElementAt(o),_=r[ee](t,0,s-1);return null===_?null:e&&_ instanceof n&&("position"===(f=p)||"rotation"===f||"scale"===f||"eulerAngles"===f)?e.createPoseWriter(_,p,i):{setValue:function(t){_[p]=t},getValue:function(){return _[p]}}},t}(),Mt=r((Nt=Rt).prototype,"path",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new re}}),Lt=r(Nt.prototype,"proxy",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Nt))||Ot)||Ot,se=t("T",e("cc.animation.Track")((Dt=function(){function t(){a(this,"_binding",Vt,this)}var e=t.prototype;return e.channels=function(){return[]},e.range=function(){for(var t,e={min:1/0,max:-1/0},n=m(this.channels());!(t=n()).done;){var i=t.value;e.min=Math.min(e.min,i.curve.rangeMin),e.max=Math.max(e.max,i.curve.rangeMax)}return e},e[te]=function(){throw new Error("No Impl")},_(t,[{key:"path",get:function(){return this._binding.path},set:function(t){this._binding.path=t}},{key:"proxy",get:function(){return this._binding.proxy},set:function(t){this._binding.proxy=t}},{key:ie,get:function(){return this._binding}}]),t}(),Vt=r((Ft=Dt).prototype,"_binding",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ae}}),zt=Ft))||zt),oe=e("cc.animation.Channel")((Qt=function(){function t(t){this.name="",a(this,"_curve",Wt,this),this._curve=t}return _(t,[{key:"curve",get:function(){return this._curve}}]),t}(),Wt=r((Bt=Qt).prototype,"_curve",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ut=Bt))||Ut,ue=e("cc.animation.SingleChannelTrack")((Kt=function(t){function e(){var e;return e=t.call(this)||this,a(e,"_channel",qt,y(e)),e._channel=new oe(e.createCurve()),e}g(e,t);var n=e.prototype;return n.channels=function(){return[this._channel]},n.createCurve=function(){throw new Error("Not impl")},n[te]=function(){var t=this._channel.curve;return new he(t)},_(e,[{key:"channel",get:function(){return this._channel}}]),e}(se),qt=r((jt=Kt).prototype,"_channel",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=jt))||Ht,he=function(){function t(t){this._curve=t}return t.prototype.evaluate=function(t){return this._curve.evaluate(t)},t}(),ce=t("R",e("cc.animation.RealTrack")(Gt=function(t){function e(){return t.apply(this,arguments)||this}return g(e,t),e.prototype.createCurve=function(){return new w},e}(ue))||Gt);function le(t){return 0===t.keyFramesCount?void 0:t}var fe,pe,_e,ve,de,me,ge,ye,we,Te,be=["X","Y","Z","W"],Ae=t("V",e("cc.animation.VectorTrack")(($t=function(t){function e(){var e;e=t.call(this)||this,a(e,"_channels",Jt,y(e)),a(e,"_nComponents",Zt,y(e)),e._channels=new Array(4);for(var n=0;n<e._channels.length;++n){var i=new oe(new w);i.name=be[n],e._channels[n]=i}return e}g(e,t);var n=e.prototype;return n.channels=function(){return this._channels},n[te]=function(){switch(this._nComponents){default:case 2:return new Se(le(this._channels[0].curve),le(this._channels[1].curve));case 3:return new Ee(le(this._channels[0].curve),le(this._channels[1].curve),le(this._channels[2].curve));case 4:return new Ce(le(this._channels[0].curve),le(this._channels[1].curve),le(this._channels[2].curve),le(this._channels[3].curve))}},_(e,[{key:"componentsCount",get:function(){return this._nComponents},set:function(t){this._nComponents=t}}]),e}(se),Jt=r((Xt=$t).prototype,"_channels",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt=r(Xt.prototype,"_nComponents",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),Yt=Xt))||Yt),Se=function(){function t(t,e){this._result=new h,this._x=t,this._y=e}return t.prototype.evaluate=function(t,e){return this._x&&this._y||!e.getValue||h.copy(this._result,e.getValue()),this._x&&(this._result.x=this._x.evaluate(t)),this._y&&(this._result.y=this._y.evaluate(t)),this._result},t}(),Ee=function(){function t(t,e,n){this._result=new c,this._x=t,this._y=e,this._z=n}return t.prototype.evaluate=function(t,e){return this._x&&this._y&&this._z||!e.getValue||c.copy(this._result,e.getValue()),this._x&&(this._result.x=this._x.evaluate(t)),this._y&&(this._result.y=this._y.evaluate(t)),this._z&&(this._result.z=this._z.evaluate(t)),this._result},t}(),Ce=function(){function t(t,e,n,i){this._result=new l,this._x=t,this._y=e,this._z=n,this._w=i}return t.prototype.evaluate=function(t,e){return this._x&&this._y&&this._z&&this._w||!e.getValue||l.copy(this._result,e.getValue()),this._x&&(this._result.x=this._x.evaluate(t)),this._y&&(this._result.y=this._y.evaluate(t)),this._z&&(this._result.z=this._z.evaluate(t)),this._w&&(this._result.w=this._w.evaluate(t)),this._result},t}(),ke=t("Q",e("cc.animation.QuatTrack")(fe=function(t){function e(){return t.apply(this,arguments)||this}g(e,t);var n=e.prototype;return n.createCurve=function(){return new T},n[te]=function(){return new Ie(this.channels()[0].curve)},e}(ue))||fe),Ie=function(){function t(t){this._result=new u,this._curve=t}return t.prototype.evaluate=function(t){return this._curve.evaluate(t,this._result),this._result},t}(),Pe=["Red","Green","Blue","Alpha"],xe=t("C",e("cc.animation.ColorTrack")((de=function(t){function e(){var e;e=t.call(this)||this,a(e,"_channels",ve,y(e)),e._channels=new Array(4);for(var n=0;n<e._channels.length;++n){var i=new oe(new w);i.name=Pe[n],e._channels[n]=i}return e}g(e,t);var n=e.prototype;return n.channels=function(){return this._channels},n[te]=function(){return new Oe(le(this._channels[0].curve),le(this._channels[1].curve),le(this._channels[2].curve),le(this._channels[3].curve))},e}(se),ve=r((_e=de).prototype,"_channels",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=_e))||pe),Oe=function(){function t(t,e,n,i){this._result=new b,this._x=t,this._y=e,this._z=n,this._w=i}return t.prototype.evaluate=function(t,e){return this._x&&this._y&&this._z&&this._w||!e.getValue||b.copy(this._result,e.getValue()),this._x&&(this._result.r=this._x.evaluate(t)),this._y&&(this._result.g=this._y.evaluate(t)),this._z&&(this._result.b=this._z.evaluate(t)),this._w&&(this._result.a=this._w.evaluate(t)),this._result},t}(),Ne=["Width","Height"],Me=t("S",e("cc.animation.SizeTrack")((we=function(t){function e(){var e;e=t.call(this)||this,a(e,"_channels",ye,y(e)),e._channels=new Array(2);for(var n=0;n<e._channels.length;++n){var i=new oe(new w);i.name=Ne[n],e._channels[n]=i}return e}g(e,t);var n=e.prototype;return n.channels=function(){return this._channels},n[te]=function(){return new Le(le(this._channels[0].curve),le(this._channels[1].curve))},e}(se),ye=r((ge=we).prototype,"_channels",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=ge))||me),Le=function(){function t(t,e){this._result=new A,this._width=t,this._height=e}return t.prototype.evaluate=function(t,e){if((!this._width||!this._height)&&e.getValue){var n=e.getValue();this._result.x=n.x,this._result.y=n.y}return this._width&&(this._result.width=this._width.evaluate(t)),this._height&&(this._result.height=this._height.evaluate(t)),this._result},t}(),Re=t("O",e("cc.animation.ObjectTrack")(Te=function(t){function e(){return t.apply(this,arguments)||this}return g(e,t),e.prototype.createCurve=function(){return new S},e}(ue))||Te),ze=Symbol("BakeNodeCurves"),Fe=t("u",function(){function t(){}return t.getOrExtract=function(e){var n=t.pool.get(e);if(!n||n.samples!==e.sample){n&&o.director.root.dataPoolManager.releaseAnimationClip(e);var i=Math.ceil(e.sample*e.duration)+1,r=e.sample;n=e[ze](0,r,i),t.pool.set(e,n)}return n},t.destroy=function(e){t.pool.delete(e)},t}());Fe.pool=new Map;var Ve=t("l",function(){function t(t){var e,n;this.ratios=void 0,this._findRatio=void 0,this.ratios=t;for(var i=!0,r=1,a=t.length;r<a;r++)if(e=t[r]-t[r-1],1===r)n=e;else if(Math.abs(e-n)>1e-6){i=!1;break}this._findRatio=i?We:k}return t.prototype.sample=function(t){return this._findRatio(this.ratios,t)},t}());o.RatioSampler=Ve;var De=t("m",function(){function t(e,n){this.types=void 0,this.type=null,this._values=[],this._lerp=void 0,this._duration=void 0,this._array=void 0,this._duration=n,this._values=e.values;var i=function(e){return"string"==typeof e?e:Array.isArray(e)?e[0]===e[1]&&e[2]===e[3]?t.Linear:t.Bezier(e):t.Linear};if(void 0!==e.easingMethod)this.type=i(e.easingMethod);else if(Array.isArray(e.easingMethods))this.types=e.easingMethods.map(i);else if(void 0!==e.easingMethods){this.types=new Array(this._values.length).fill(null);for(var r=0,a=Object.keys(e.easingMethods);r<a.length;r++){var s=a[r];this.types[s]=i(e.easingMethods[s])}}else this.type=null;var o=e.values[0];(void 0===e.interpolate||e.interpolate)&&(this._lerp=Je(o)),void 0!==e._arrayLength&&(this._array=new Array(e._arrayLength))}t.Bezier=function(t){return t};var e=t.prototype;return e.hasLerp=function(){return!!this._lerp},e.valueAt=function(t){if(void 0===this._array){var e=this._values[t];return e&&e.getNoLerp?e.getNoLerp():e}for(var n=0;n<this._array.length;++n)this._array[n]=this._values[this._array.length*t+n];return this._array},e.valueBetween=function(t,e,n,i,r){if(this._lerp){var a=this.types?this.types[e]:this.type,s=r-n,o=(t-n)/s;if(a&&(o=Be(o,a)),void 0===this._array){var u=this._values[e],h=this._values[i];return this._lerp(u,h,o,s*this._duration)}for(var c=0;c<this._array.length;++c){var l=this._values[this._array.length*e+c],f=this._values[this._array.length*i+c];this._array[c]=this._lerp(l,f,o,s*this._duration)}return this._array}if(void 0===this._array)return this.valueAt(e);for(var p=0;p<this._array.length;++p)this._array[p]=this._values[this._array.length*e+p];return this._array},e.empty=function(){return 0===this._values.length},e.constant=function(){return 1===this._values.length},t}());function Ue(t,e,n){var i=e.sample(n);if(i<0)if((i=~i)<=0)i=0;else{if(!(i>=e.ratios.length))return t.valueBetween(n,i-1,e.ratios[i-1],i,e.ratios[i]);i=e.ratios.length-1}return t.valueAt(i)}function Be(t,e){if("string"==typeof e){var n=E[e];n?t=n(t):d(3906,e)}else Array.isArray(e)&&(t=C(e,t));return t}function We(t,e){var n=t.length-1;if(0===n)return 0;var i=t[0];if(e<i)return 0;var r=t[n];if(e>r)return n;var a=(e=(e-i)/(r-i))/(1/n),s=0|a,o=1e-6;return a-s<o?s:s+1-a<o?s+1:~(s+1)}De.Linear=null,o.AnimCurve=De,t("E",function(){function t(){this.events=[]}return t.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})},t}()),o.sampleAnimationCurve=Ue;var Qe,He,je,qe,Ke,Ge,Ye,Xe,Je=function(){function t(t,e,n,i){return t.lerp(e,n,i)}return function(e){if(null!==e){if("number"==typeof e)return I;if("object"==typeof e&&e.constructor){if(e instanceof u)return n=new u,function(t,e,i){return u.slerp(n,t,e,i)};if(e instanceof P)return function(t){var e=new t;return function(n,i,r){return t.lerp(e,n,i,r),e}}(e.constructor);if(e.constructor===Number)return I;if(x(e))return t}var n}}}(),Ze=e("cc.animation.UntypedTrackChannel")((qe=function(t){function e(){var e;return e=t.call(this,new w)||this,a(e,"property",je,y(e)),e}return g(e,t),e}(oe),je=r((He=qe).prototype,"property",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Qe=He))||Qe,$e=e("cc.animation.UntypedTrack")((Xe=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i))||this,a(e,"_channels",Ye,y(e)),e}g(e,t);var n=e.prototype;return n.channels=function(){return this._channels},n[te]=function(t){var e=this;if(!t.getValue)throw new Error(O(3930));var n=function(t){var n;return null===(n=e._channels.find((function(e){return e.property===t})))||void 0===n?void 0:n.curve},i=t.getValue();switch(!0){default:throw new Error(O(3931));case i instanceof h:return new Se(n("x"),n("y"));case i instanceof c:return new Ee(n("x"),n("y"),n("z"));case i instanceof l:return new Ce(n("x"),n("y"),n("z"),n("w"));case i instanceof b:return new Oe(n("r"),n("g"),n("b"),n("a"));case i instanceof A:return new Le(n("width"),n("height"))}},n.addChannel=function(t){var e=new Ze;return e.property=t,this._channels.push(e),e},n.upgrade=function(t){var e=this,n=function(t,n){var i=e.channels().find((function(e){return e.property===t}));i&&(n.name=i.name,n.curve.assignSorted(Array.from(i.curve.times()),Array.from(i.curve.values())))},i=t(this.path,this.proxy);switch(i){default:break;case"vec2":case"vec3":case"vec4":var r=new Ae;r.path=this.path,r.proxy=this.proxy,r.componentsCount="vec2"===i?2:"vec3"===i?3:4;var a=r.channels(),s=a[0],o=a[1],u=a[2],h=a[3];switch(i){case"vec4":n("w",h);case"vec3":n("z",u);default:case"vec2":n("x",s),n("y",o)}return r;case"color":var c=new xe,l=c.channels(),f=l[0],p=l[1],_=l[2],v=l[3];return n("r",f),n("g",p),n("b",_),n("a",v),n("x",f),n("y",p),n("z",_),n("w",v),c;case"size":}return null},e}(se),Ye=r((Ge=Xe).prototype,"_channels",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ke=Ge))||Ke,tn=function(){function t(t){this._keys=[],this._curves=[],this._commonTargets=[],this._ratioSamplers=[],this._runtimeCurves=void 0,this._data=null,this._duration=void 0,this._duration=t}var e=t.prototype;return e.getPropertyCurves=function(){return this._runtimeCurves||this._createPropertyCurves(),this._runtimeCurves},e.toTracks=function(){for(var t,e=[],n=this.keys,r=this.curves,a=this.commonTargets,s=function(t,e,n){for(var i,r=new re,a=m(e);!(i=a()).done;){var s=i.value;"string"==typeof s?r.toProperty(s):"number"==typeof s?r.toElement(s):s instanceof yt?r.toHierarchy(s.path):s instanceof wt?r.toComponent(s.component):r.toCustomized(s)}t.path=r,t.proxy=n},o=a.map((function(t){var n=new $e;return s(n,t.modifiers,t.valueAdapter),e.push(n),n})),f=function(){var r,a=t.value,f=a.data,_=f.values;if(0===_.length)return"continue";var v=f.keys<0?[0]:n[f.keys],d=_[0],m=null===(r=f.interpolate)||void 0===r||r;p("number"!=typeof f._arrayLength||"number"==typeof d);var g=new nn(f,v.length),y=function(t){s(t,a.modifiers,a.valueAdapter)},w=void 0;if("number"==typeof a.commonTarget){if(!_.every((function(t){return"number"==typeof t})))return i(3932),"continue";if(a.valueAdapter||1!==a.modifiers.length||"string"!=typeof a.modifiers[0])return i(3933),"continue";var T=a.modifiers[0],S=o[a.commonTarget].addChannel(T).curve;w=S}!function(){if("number"==typeof d){if(!_.every((function(t){return"number"==typeof t})))return void i(3934);var t;if(w)t=w;else{var n=new ce;y(n),e.push(n),t=n.channel.curve}var r=m?M.LINEAR:M.CONSTANT;return t.assignSorted(v,_.map((function(t){return{value:t,interpolationMode:r}}))),void g.convert(t)}if("object"==typeof d)switch(!0){default:break;case en(_,h):case en(_,c):case en(_,l):var a=d instanceof h?2:d instanceof c?3:4,s=new Ae;y(s),s.componentsCount=a;var o=s.channels(),f=o[0].curve,p=o[1].curve,T=o[2].curve,S=o[3].curve,E=m?M.LINEAR:M.CONSTANT,C=function(t){return{value:t,interpolationMode:E}};switch(a){case 4:S.assignSorted(v,_.map((function(t){return C(t.w)}))),g.convert(S);case 3:T.assignSorted(v,_.map((function(t){return C(t.z)}))),g.convert(T);default:f.assignSorted(v,_.map((function(t){return C(t.x)}))),g.convert(f),p.assignSorted(v,_.map((function(t){return C(t.y)}))),g.convert(p)}return void e.push(s);case en(_,u):var k=new ke;y(k);var I=m?R.SLERP:R.CONSTANT;return k.channel.curve.assignSorted(v,_.map((function(t){return{value:u.clone(t),interpolationMode:I}}))),g.convertQuatCurve(k.channel.curve),void e.push(k);case en(_,b):var P=new xe;y(P);var x=P.channels(),O=x[0].curve,N=x[1].curve,L=x[2].curve,z=x[3].curve,F=m?M.LINEAR:M.CONSTANT,V=function(t){return{value:t,interpolationMode:F}};return O.assignSorted(v,_.map((function(t){return V(t.r)}))),g.convert(O),N.assignSorted(v,_.map((function(t){return V(t.g)}))),g.convert(N),L.assignSorted(v,_.map((function(t){return V(t.b)}))),g.convert(L),z.assignSorted(v,_.map((function(t){return V(t.a)}))),g.convert(z),void e.push(P);case en(_,A):var D=new Me;y(D);var U=D.channels(),B=U[0].curve,W=U[1].curve,Q=m?M.LINEAR:M.CONSTANT,H=function(t){return{value:t,interpolationMode:Q}};return B.assignSorted(v,_.map((function(t){return H(t.width)}))),g.convert(B),W.assignSorted(v,_.map((function(t){return H(t.height)}))),g.convert(W),void e.push(D);case en(_,Ct):var j=new ce;y(j);var q=m?M.CUBIC:M.CONSTANT;return j.channel.curve.assignSorted(v,_.map((function(t){return{value:t.dataPoint,leftTangent:t.inTangent,rightTangent:t.outTangent,interpolationMode:q}}))),void e.push(j);case en(_,bt):case en(_,At):case en(_,St):var K=d instanceof bt?2:d instanceof At?3:4,G=new Ae;y(G),G.componentsCount=K;var Y=G.channels(),X=Y[0],J=Y[1],Z=Y[2],$=Y[3],tt=m?M.LINEAR:M.CONSTANT,et=function(t,e,n){return{value:t,leftTangent:e,rightTangent:n,interpolationMode:tt}};switch(K){case 4:$.curve.assignSorted(v,_.map((function(t){return et(t.dataPoint.w,t.inTangent.w,t.outTangent.w)})));case 3:Z.curve.assignSorted(v,_.map((function(t){return et(t.dataPoint.z,t.inTangent.z,t.outTangent.z)})));default:X.curve.assignSorted(v,_.map((function(t){return et(t.dataPoint.y,t.inTangent.y,t.outTangent.y)}))),J.curve.assignSorted(v,_.map((function(t){return et(t.dataPoint.x,t.inTangent.x,t.outTangent.x)})))}return void e.push(G);case _.every((function(t){return t instanceof Et})):i(3935)}var nt=new Re;y(nt),nt.channel.curve.assignSorted(v,_),e.push(nt)}()},_=m(r);!(t=_()).done;)f();return e},e._createPropertyCurves=function(){var t=this;this._ratioSamplers=this._keys.map((function(e){return new Ve(e.map((function(e){return e/t._duration})))})),this._runtimeCurves=this._curves.map((function(e){return{curve:new De(e.data,t._duration),modifiers:e.modifiers,valueAdapter:e.valueAdapter,sampler:t._ratioSamplers[e.data.keys],commonTarget:e.commonTarget}}))},_(t,[{key:"keys",get:function(){return this._keys},set:function(t){this._keys=t}},{key:"curves",get:function(){return this._curves},set:function(t){this._curves=t,delete this._runtimeCurves}},{key:"commonTargets",get:function(){return this._commonTargets},set:function(t){this._commonTargets=t}},{key:"data",get:function(){return this._data}}]),t}();function en(t,e){return t.every((function(t){return t instanceof e}))}var nn=function(){function t(t,e){this._easingMethods=void 0;var n=t.easingMethods;Array.isArray(n)?0===n.length&&0!==e?this._easingMethods=new Array(e).fill(null):this._easingMethods=n:this._easingMethods=void 0===n?new Array(e).fill(t.easingMethod):Array.from({length:e},(function(t,e){var i;return null!==(i=n[e])&&void 0!==i?i:null}))}var e=t.prototype;return e.convert=function(t){var e,n,i,r,a,s,o,u,h,c,l,f,_,v,d,m,g,y,w,T,b,A,S=this._easingMethods;if(S){var E=t.keyFramesCount;if(!(t.keyFramesCount<2)){Array.isArray(S)&&p(E===S.length);for(var C=E-1,k=0;k<C;++k){var I=S[k];I&&(Array.isArray(I)?(e=I,n=t.getKeyframeTime(k),i=t.getKeyframeValue(k),r=t.getKeyframeTime(k+1),a=t.getKeyframeValue(k+1),s=void 0,o=void 0,u=void 0,h=void 0,c=void 0,l=void 0,f=void 0,_=void 0,v=void 0,d=void 0,m=void 0,g=void 0,y=void 0,w=void 0,T=void 0,b=void 0,A=void 0,o=e[0],u=e[1],h=e[2],c=e[3],l=i.value,f=3*(r-n),_=3*(a.value-l),m=(1-h)*f,g=(1-c)*_,y=1/3,w=(d=u*_)/(v=o*f),T=Math.sqrt(v*v+d*d)*y,b=g/m,A=Math.sqrt(m*m+g*g)*y,i.interpolationMode=M.CUBIC,i.tangentWeightMode=(s=i.tangentWeightMode)===L.NONE?L.RIGHT:s===L.LEFT?L.BOTH:s,i.rightTangent=w,i.rightTangentWeight=T,a.tangentWeightMode=function(t){return t===L.NONE?L.LEFT:t===L.RIGHT?L.BOTH:t}(a.tangentWeightMode),a.leftTangent=b,a.leftTangentWeight=A):rn(I,t,k))}}}},e.convertQuatCurve=function(t){var e=this._easingMethods;if(e){var n=t.keyFramesCount;if(!(t.keyFramesCount<2)){Array.isArray(e)&&p(n===e.length);for(var i=n-1,r=0;r<i;++r){var a=e[r];a&&(Array.isArray(a)?t.getKeyframeValue(r).easingMethod=a.slice():an(a,t,r))}}}},_(t,[{key:"nil",get:function(){return!this._easingMethods||this._easingMethods.every((function(t){return null==t}))}}]),t}();function rn(t,e,n){p(n!==e.keyFramesCount-1);var i=e.getKeyframeValue(n),r=Rn[t];r===N.CONSTANT?i.interpolationMode=M.CONSTANT:(i.interpolationMode=M.LINEAR,i.easingMethod=r)}function an(t,e,n){p(n!==e.keyFramesCount-1);var i=e.getKeyframeValue(n),r=Rn[t];i.easingMethod=r}var sn,on,un,hn,cn,ln,fn,pn,_n,vn,dn,mn,gn,yn,wn,Tn,bn,An,Sn,En,Cn,kn,In,Pn,xn,On,Nn,Mn,Ln,Rn={constant:N.CONSTANT,linear:N.LINEAR,quadIn:N.QUAD_IN,quadOut:N.QUAD_OUT,quadInOut:N.QUAD_IN_OUT,quadOutIn:N.QUAD_OUT_IN,cubicIn:N.CUBIC_IN,cubicOut:N.CUBIC_OUT,cubicInOut:N.CUBIC_IN_OUT,cubicOutIn:N.CUBIC_OUT_IN,quartIn:N.QUART_IN,quartOut:N.QUART_OUT,quartInOut:N.QUART_IN_OUT,quartOutIn:N.QUART_OUT_IN,quintIn:N.QUINT_IN,quintOut:N.QUINT_OUT,quintInOut:N.QUINT_IN_OUT,quintOutIn:N.QUINT_OUT_IN,sineIn:N.SINE_IN,sineOut:N.SINE_OUT,sineInOut:N.SINE_IN_OUT,sineOutIn:N.SINE_OUT_IN,expoIn:N.EXPO_IN,expoOut:N.EXPO_OUT,expoInOut:N.EXPO_IN_OUT,expoOutIn:N.EXPO_OUT_IN,circIn:N.CIRC_IN,circOut:N.CIRC_OUT,circInOut:N.CIRC_IN_OUT,circOutIn:N.CIRC_OUT_IN,elasticIn:N.ELASTIC_IN,elasticOut:N.ELASTIC_OUT,elasticInOut:N.ELASTIC_IN_OUT,elasticOutIn:N.ELASTIC_OUT_IN,backIn:N.BACK_IN,backOut:N.BACK_OUT,backInOut:N.BACK_IN_OUT,backOutIn:N.BACK_OUT_IN,bounceIn:N.BOUNCE_IN,bounceOut:N.BOUNCE_OUT,bounceInOut:N.BOUNCE_IN_OUT,bounceOutIn:N.BOUNCE_OUT_IN,smooth:N.SMOOTH,fade:N.FADE};function zn(){throw new Error("split() only valid in Editor.")}e("cc.animation.ExoticAnimation")((un=function(){function t(){a(this,"_nodeAnimations",on,this)}var e=t.prototype;return e.createEvaluator=function(t){return new qn(this._nodeAnimations,t)},e.addNodeAnimation=function(t){var e=new Fn(t);return this._nodeAnimations.push(e),e},e.collectAnimatedJoints=function(){return Array.from(new Set(this._nodeAnimations.map((function(t){return t.path}))))},e.split=function(){return zn()},e.toHashString=function(){return this._nodeAnimations.map((function(t){return t.toHashString()})).join("\n")},t}(),on=r((sn=un).prototype,"_nodeAnimations",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),sn));var Fn=e("cc.animation.ExoticNodeAnimation")((vn=function(){function t(t){a(this,"_path",ln,this),a(this,"_position",fn,this),a(this,"_rotation",pn,this),a(this,"_scale",_n,this),this._path=t}var e=t.prototype;return e.createPosition=function(t,e){this._position=new Qn(t,new Bn(e))},e.createRotation=function(t,e){this._rotation=new Qn(t,new Wn(e))},e.createScale=function(t,e){this._scale=new Qn(t,new Bn(e))},e.createEvaluator=function(t){return new Kn(this._path,this._position,this._rotation,this._scale,t)},e.split=function(){return zn()},e.toHashString=function(){var t,e,n,i,r,a;return this._path+"\n"+(null!==(t=null===(e=this._position)||void 0===e?void 0:e.toHashString())&&void 0!==t?t:"")+(null!==(n=null===(i=this._scale)||void 0===i?void 0:i.toHashString())&&void 0!==n?n:"")+(null!==(r=null===(a=this._rotation)||void 0===a?void 0:a.toHashString())&&void 0!==r?r:"")},_(t,[{key:"path",get:function(){return this._path}}]),t}(),ln=r((cn=vn).prototype,"_path",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),fn=r(cn.prototype,"_position",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pn=r(cn.prototype,"_rotation",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_n=r(cn.prototype,"_scale",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hn=cn))||hn;function Vn(t){return t.toPrecision(2)}function Dn(t){return t.map(Vn).join(" ")}var Un=e("cc.animation.ExoticVectorLikeTrackValues")((wn=function(){function t(t){a(this,"_values",gn,this),a(this,"_isQuantized",yn,this),this._values=t,this._isQuantized=!1}var e=t.prototype;return e.quantize=function(t){p(!this._isQuantized),this._values=function(t,e){var n=Yn[e],i=1<<n.BYTES_PER_ELEMENT,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;t.forEach((function(t){r=Math.min(t,r),a=Math.max(t,a)}));var s=a-r,o=n.from(t,(function(t){return(t-r)/s*i}));return new ci(Xn(t),o,s,r)}(this._values,t),this._isQuantized=!0},e.toHashString=function(){var t=this._isQuantized,e=this._values;return t+" "+(t?e.toHashString():Dn(e))},_(t,[{key:"precision",get:function(){return this._isQuantized?this._values.originalPrecision:Xn(this._values)}}]),t}(),gn=r((mn=wn).prototype,"_values",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=r(mn.prototype,"_isQuantized",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=mn))||dn,Bn=e("cc.animation.ExoticVec3TrackValues")(Tn=function(t){function e(){return t.apply(this,arguments)||this}g(e,t),e.imitate=function(t,n){var i=new e(t);return n._isQuantized&&i.quantize(n._values.quantizationType),i};var n=e.prototype;return n.get=function(t,e){var n=this._values;this._isQuantized?pi(n,t,e):c.fromArray(e,n,3*t)},n.lerp=function(t,e,n,i,r,a){var s=this._values;this._isQuantized?(pi(s,t,i),pi(s,e,r)):(c.fromArray(i,s,3*t),c.fromArray(r,s,3*e)),c.lerp(a,i,r,n)},e}(Un))||Tn,Wn=e("cc.animation.ExoticQuatTrackValues")(bn=function(t){function e(){return t.apply(this,arguments)||this}g(e,t),e.imitate=function(t,n){var i=new e(t);return n._isQuantized&&i.quantize(n._values.quantizationType),i};var n=e.prototype;return n.get=function(t,e){var n=this._values;this._isQuantized?_i(n,t,e):u.fromArray(e,n,4*t)},n.lerp=function(t,e,n,i,r,a){var s=this._values;this._isQuantized?(_i(s,t,i),_i(s,e,r)):(u.fromArray(i,s,4*t),u.fromArray(r,s,4*e)),u.slerp(a,i,r,n)},e}(Un))||bn,Qn=e("cc.animation.ExoticTrack")((kn=function(){function t(t,e){a(this,"times",En,this),a(this,"values",Cn,this),this.times=t,this.values=e}return t.prototype.toHashString=function(){var t=this.times,e=this.values;return"times: "+Dn(t)+"; values: "+e.toHashString()},t}(),En=r((Sn=kn).prototype,"times",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=r(Sn.prototype,"values",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Sn))||An;function Hn(t,e){t.length,p(0!==t.length);var n=0,i=0,r=k(t,e);if(r>=0)n=r;else{var a=~r,s=a-1;n=s;var o=t[a],u=t[s];i=(e-u)/(o-u)}return{index:n,ratio:i}}!function(){function t(){this._reset()}var e=t.prototype;e.transformTime=function(t){return t-this._timeOffset},e.calculate=function(t,e,n){this._reset();var i=t.length;if(i){var r=t[0],a=t[i-1],s=z(e,r,a),o=z(n,r,a);this._timeOffset=s;var u=function(t,e,n){var i=t.length;p(n>=e&&e>=t[0]&&n<=t[i-1]);var r=Hn(t,e),a=r.index,s=r.ratio,o=Hn(t,n);return{fromIndex:a,fromRatio:s,toIndex:o.index,toRatio:o.ratio}}(t,s,o),h=u.fromIndex,c=u.fromRatio,l=u.toIndex,f=u.toRatio,_=!c,v=!f;h!==l||c!==f?(_||(this.preLerpIndex=h,this.preLerpRatio=c),this.directKeyframesBegin=_?h:h+1,this.directKeyframesEnd=l+1,v||(this.postLerpIndex=l,this.postLerpRatio=f)):_?(this.directKeyframesBegin=h,this.directKeyframesEnd=h+1):(this.preLerpIndex=h,this.preLerpRatio=c)}},e._reset=function(){this.preLerpIndex=-1,this.preLerpRatio=0,this.directKeyframesBegin=0,this.directKeyframesEnd=0,this.postLerpIndex=-1,this.postLerpRatio=0,this._timeOffset=0},_(t,[{key:"keyframesCount",get:function(){var t=this.preLerpIndex,e=this.directKeyframesBegin;return 0+(t<0?0:1)+(this.directKeyframesEnd-e)+(this.postLerpIndex<0?0:1)}}])}();var jn,qn=function(){function t(t,e){this._nodeEvaluations=void 0,this._nodeEvaluations=t.map((function(t){return t.createEvaluator(e)}))}return t.prototype.evaluate=function(t){this._nodeEvaluations.forEach((function(e){e.evaluate(t)}))},t}(),Kn=function(){function t(t,e,n,i,r){this._position=null,this._rotation=null,this._scale=null,e&&(this._position=fi(e.times,e.values,c,t,"position",r)),n&&(this._rotation=fi(n.times,n.values,u,t,"rotation",r)),i&&(this._scale=fi(i.times,i.values,c,t,"scale",r))}return t.prototype.evaluate=function(t){if(this._position){var e=this._position.evaluator.evaluate(t);this._position.runtimeBinding.setValue(e)}if(this._rotation){var n=this._rotation.evaluator.evaluate(t);this._rotation.runtimeBinding.setValue(n)}if(this._scale){var i=this._scale.evaluator.evaluate(t);this._scale.runtimeBinding.setValue(i)}},t}(),Gn=function(){function t(t,e,n){this._times=void 0,this._inputSampleResultCache={just:!1,index:-1,nextIndex:-1,ratio:0},this._values=void 0,this._prevValue=void 0,this._nextValue=void 0,this._resultValue=void 0,this._times=t,this._values=e,this._prevValue=new n,this._nextValue=new n,this._resultValue=new n}return t.prototype.evaluate=function(t){var e=this._times,n=this._values,i=this._resultValue;if(0===e.length)return i;var r=function(t,e,n){var i=t.length,r=t[0],a=t[i-1];if(e<r)n.just=!0,n.index=0;else if(e>a)n.just=!0,n.index=i-1;else{var s=k(t,e);if(s>=0)n.just=!0,n.index=s;else{var o=~s,u=o-1,h=t[u],c=t[o],l=(e-t[u])/(c-h);n.just=!1,n.index=u,n.nextIndex=o,n.ratio=l}}return n}(e,t,this._inputSampleResultCache);return r.just?n.get(r.index,i):n.lerp(r.index,r.nextIndex,r.ratio,this._prevValue,this._nextValue,i),i},t}(),Yn={uint8:Uint8Array,uint16:Uint16Array};function Xn(t){switch(t.BYTES_PER_ELEMENT){default:case 4:return jn.FLOAT_32;case 8:return jn.FLOAT_64}}!function(t){t[t.FLOAT_32=0]="FLOAT_32",t[t.FLOAT_64=1]="FLOAT_64"}(jn||(jn={}));var Jn,Zn,$n,ti,ei,ni,ii,ri,ai,si,oi,ui,hi,ci=e("cc.animation.QuantizedFloatArray")((Ln=function(){function t(t,e,n,i){void 0===i&&(i=0),a(this,"originalPrecision",xn,this),a(this,"min",On,this),a(this,"extent",Nn,this),a(this,"values",Mn,this),this.originalPrecision=t,this.values=e,this.extent=n,this.min=i}return t.prototype.toHashString=function(){var t=this.originalPrecision,e=this.min,n=this.extent,i=this.values;return t+" "+Vn(e)+" "+Vn(n)+" "+i.join(" ")},_(t,[{key:"quantizationType",get:function(){switch(this.values.BYTES_PER_ELEMENT){default:case 1:return"uint8";case 2:return"uint16"}}}]),t}(),xn=r((Pn=Ln).prototype,"originalPrecision",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=r(Pn.prototype,"min",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=r(Pn.prototype,"extent",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=r(Pn.prototype,"values",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Pn))||In;function li(t,e){return t.values[e]/(1<<t.values.BYTES_PER_ELEMENT)*t.extent+t.min}function fi(t,e,n,i,r,a){var s=new ae;s.path=(new re).toHierarchy(i).toProperty(r);var o=a(s);return o?{runtimeBinding:o,evaluator:new Gn(t,e,n)}:null}function pi(t,e,n){c.set(n,li(t,3*e+0),li(t,3*e+1),li(t,3*e+2))}function _i(t,e,n){u.set(n,li(t,4*e+0),li(t,4*e+1),li(t,4*e+2),li(t,4*e+3))}var vi=Symbol("SearchForRootBonePath"),di=Symbol("ExoticAnimation"),mi=t("A",e("cc.AnimationClip")((hi=ui=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i))||this,a(e,"sample",$n,y(e)),a(e,"speed",ti,y(e)),a(e,"wrapMode",ei,y(e)),a(e,"enableTrsBlending",ni,y(e)),a(e,"_duration",ii,y(e)),a(e,"_hash",ri,y(e)),e.frameRate=0,a(e,"_tracks",ai,y(e)),a(e,"_exoticAnimation",si,y(e)),e._legacyData=void 0,e._legacyDataDirty=!1,a(e,"_events",oi,y(e)),e._runtimeEvents={ratios:[],eventGroups:[]},e}g(e,t),e.createWithSpriteFrames=function(t,n){var i=new e;i.sample=n||i.sample,i.duration=t.length/i.sample;var r=1/i.sample,a=new Re;return a.path=(new re).toComponent("cc.Sprite").toProperty("spriteFrame"),a.channels()[0].curve.assignSorted(t.map((function(t,e){return[r*e,t]}))),i};var r=e.prototype;return r.onLoaded=function(){this.frameRate=this.sample,this.events=this._events},r.range=function(){for(var t={min:1/0,max:-1/0},e=this._tracks,n=e.length,i=0;i<n;++i){var r=e[i].range();t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max)}return t},r.getTrack=function(t){return this._tracks[t]},r.addTrack=function(t){var e=this._tracks.length;return this._tracks.push(t),e},r.removeTrack=function(t){this._tracks.splice(t,1)},r.clearTracks=function(){this._tracks.length=0},r.createEventEvaluator=function(t){return new Ei(t,this._runtimeEvents.ratios,this._runtimeEvents.eventGroups,this.wrapMode)},r.createEvaluator=function(t){var e=this,n=t.target;return this._createEvalWithBinder(n,(function(i){var r=i.createRuntimeBinding(n,e.enableTrsBlending?t.pose:void 0,!1);return null!=r?r:void 0}),t.rootMotion)},r.destroy=function(){var e;return(null===(e=o.director.root)||void 0===e?void 0:e.dataPoolManager)&&o.director.root.dataPoolManager.releaseAnimationClip(this),Fe.destroy(this),t.prototype.destroy.call(this)},r[ze]=function(t,e,n){for(var i=1/e,r=this._collectAnimatedJoints(),a=r.length,s={},o=0;o<a;++o)s[r[o]]={transforms:Array.from({length:n},(function(){return new F}))};var u=r.reduce((function(t,e){return t[e]=new wi,t}),{});for(var h in u){var c=u[h],l=h.lastIndexOf("/");if(l>=0){var f=h.substring(0,l),p=u[f];p&&(c.parent=p)}}for(var _=this._createEvalWithBinder(void 0,(function(t){var e=t.parseTrsPath();if(e){var n=u[e.node];if(n)return Si(n,e.property)}}),void 0),v=0;v<n;++v){var d=t+i*v;_.evaluate(d);for(var m=0;m<a;++m){var g=r[m];F.copy(s[g].transforms[v],u[g].globalTransform)}for(var y=0;y<a;++y){var w=r[y];u[w].invalidate()}}return{samples:e,frames:n,joints:s}},r.upgradeUntypedTracks=function(t){for(var e=[],n=[],i=this._tracks,r=i.length,a=0;a<r;++a){var s=i[a];if(s instanceof $e){var o=s.upgrade(t);o&&(e.push(o),n.push(s))}}for(var u=n.length,h=0;h<u;++h)V.remove(i,n[h]);i.push.apply(i,e)},r[vi]=function(){return this._searchForRootBonePath()},r.getPropertyCurves=function(){return this._getLegacyData().getPropertyCurves()},r.updateEventDatas=function(){},r.hasEvents=function(){return 0!==this.events.length},r.syncLegacyData=function(){this._legacyData&&(this._fromLegacy(this._legacyData),this._legacyData=void 0)},r._createEvalWithBinder=function(t,e,n){this._legacyDataDirty&&(this._legacyDataDirty=!1,this.syncLegacyData());var i,r=[];n&&(i=this._createRootMotionEvaluation(t,n,r));for(var a,s=[],o=this._tracks,u=o.length,h=0;h<u;++h){var c=o[h];if(!r.includes(c)){var l=e(c[ie]);if(l){var f=c[te](l);s.push({binding:l,trackEval:f})}}}return this._exoticAnimation&&(a=this._exoticAnimation.createEvaluator(e)),new gi(s,a,i)},r._createRootMotionEvaluation=function(t,e,r){if(t instanceof n){var a=this._searchForRootBonePath();if(a){var s=t.getChildByPath(a);if(s){for(var o=new yi,u=[],h=this._tracks,c=h.length,l=0;l<c;++l){var f=h[l],p=f[ie].parseTrsPath();if(p&&p.node===a){r.push(f);var _=Si(o,p.property);if(_){var v=f[te](_);u.push({binding:_,trackEval:v})}}}return new bi(s,this._duration,o,u)}i(3924)}else i(3923)}else d(3920)},r._searchForRootBonePath=function(){var t=this._tracks.map((function(t){var e=t[ie].parseTrsPath();if(e){var n=e.node;return{path:n,rank:n.split("/").length}}return{path:"",rank:0}}));t.sort((function(t,e){return t.rank-e.rank}));var e=t.findIndex((function(t){return 0!==t.rank}));if(e<0)return"";for(var n=t.length,i=t[e],r=!0,a=e+1;a<n;++a){var s=t[a];if(s.rank!==i.rank)break;if(s.path!==i.path){r=!1;break}}return r?i.path:""},r._getLegacyData=function(){return this._legacyData||(this._legacyData=this._toLegacy()),this._legacyData},r._toLegacy=function(){var t=new tn(this._duration);return t.keys=[],t.curves=[],t.commonTargets=[],t},r._fromLegacy=function(t){for(var e=t.toTracks(),n=e.length,i=0;i<n;++i)this.addTrack(e[i])},r._collectAnimatedJoints=function(){for(var t=new Set,e=this._tracks,n=e.length,i=0;i<n;++i){var r=e[i][ie].parseTrsPath();r&&t.add(r.node)}if(this._exoticAnimation)for(var a=this._exoticAnimation.collectAnimatedJoints(),s=a.length,o=0;o<s;++o)t.add(a[o]);return Array.from(t)},_(e,[{key:"duration",get:function(){return this._duration},set:function(t){this._duration=t}},{key:"tracksCount",get:function(){return this._tracks.length}},{key:"tracks",get:function(){return this._tracks}},{key:"hash",get:function(){var t,e;if(this._hash)return this._hash;var n="Exotic:"+(null!==(t=null===(e=this._exoticAnimation)||void 0===e?void 0:e.toHashString())&&void 0!==t?t:"");return this._hash=B(n,666)}},{key:"events",get:function(){return this._events},set:function(t){var e=this;this._events=t;for(var n=[],i=[],r=this.events.sort((function(t,e){return t.frame-e.frame})),a=r.length,s=function(t){var a=r[t],s=a.frame/e._duration,o=n.findIndex((function(t){return t===s}));o<0&&(o=n.length,n.push(s),i.push({events:[]})),i[o].events.push({functionName:a.func,parameters:a.params})},o=0;o<a;++o)s(o);this._runtimeEvents={ratios:n,eventGroups:i}}},{key:di,get:function(){return this._exoticAnimation}},{key:di,set:function(t){this._exoticAnimation=t}},{key:"keys",get:function(){return this._getLegacyData().keys}},{key:"keys",set:function(t){this._legacyDataDirty=!0,this._getLegacyData().keys=t}},{key:"curves",get:function(){return this._legacyDataDirty=!0,this._getLegacyData().curves}},{key:"curves",set:function(t){this._getLegacyData().curves=t}},{key:"commonTargets",get:function(){return this._getLegacyData().commonTargets}},{key:"commonTargets",set:function(t){this._legacyDataDirty=!0,this._getLegacyData().commonTargets=t}},{key:"data",get:function(){return this._getLegacyData().data}},{key:"eventGroups",get:function(){return this._runtimeEvents.eventGroups}}]),e}(D),ui.WrapMode=U,$n=r((Zn=hi).prototype,"sample",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),ti=r(Zn.prototype,"speed",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ei=r(Zn.prototype,"wrapMode",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return U.Normal}}),ni=r(Zn.prototype,"enableTrsBlending",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ii=r(Zn.prototype,"_duration",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ri=r(Zn.prototype,"_hash",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ai=r(Zn.prototype,"_tracks",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),si=r(Zn.prototype,"_exoticAnimation",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oi=r(Zn.prototype,"_events",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Jn=Zn))||Jn);o.AnimationClip=mi;var gi=function(){function t(t,e,n){this._exoticAnimationEvaluator=void 0,this._trackEvalStatues=[],this._rootMotionEvaluation=void 0,this._trackEvalStatues=t,this._exoticAnimationEvaluator=e,this._rootMotionEvaluation=n}var e=t.prototype;return e.evaluate=function(t){for(var e=this._trackEvalStatues,n=this._exoticAnimationEvaluator,i=e.length,r=0;r<i;++r){var a=e[r],s=a.trackEval,o=a.binding,u=s.evaluate(t,o);o.setValue(u)}n&&n.evaluate(t)},e.evaluateRootMotion=function(t,e){var n=this._rootMotionEvaluation;n&&n.evaluate(t,e)},t}(),yi=function(){function t(){this.position=new c,this.scale=new c(1,1,1),this.rotation=new u,this.eulerAngles=new c}return t.prototype.getTransform=function(t){F.fromRTS(t,this.rotation,this.position,this.scale)},t}(),wi=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).parent=null,e._dirty=!0,e._transform=new F,e}return g(e,t),e.prototype.invalidate=function(){this._dirty=!0},_(e,[{key:"globalTransform",get:function(){var t=this._transform;return this._dirty&&(this._dirty=!1,F.fromRTS(t,this.rotation,this.position,this.scale),this.parent&&F.multiply(t,this.parent.globalTransform,t)),this._transform}}]),e}(yi),Ti=new F,bi=function(){function t(t,e,n,i){this._initialTransformCache=new F,this._clipEndTransformCache=new F,this._startTransformCache=new F,this._endTransformCache=new F,this._motionTransformCache=new F,this._translationMotionCache=new c,this._rotationMotionCache=new u,this._scaleMotionCache=new c,this._rootBone=t,this._duration=e,this._boneTransform=n,this._trackEvalStatuses=i}var e=t.prototype;return e.evaluate=function(t,e){var n=this._calcMotionTransform(t,e,this._motionTransformCache),i=this._translationMotionCache,r=this._rotationMotionCache,a=this._scaleMotionCache,s=this._rootBone;F.toRTS(n,r,i,a),c.add(i,i,s.position),s.setPosition(i),u.multiply(r,r,s.rotation),s.setRotation(r),c.multiply(a,a,s.scale),s.setScale(a)},e._calcMotionTransform=function(t,e,n){var i=this._duration,r=i-t,a=this._evaluateAt(t,this._startTransformCache);if(e<r){var s=this._evaluateAt(t+e,this._endTransformCache);Ai(n,a,s)}else{F.identity(n);var o=function(t,e){Ai(Ti,t,e),F.multiply(n,n,Ti)},u=e-r,h=Math.floor(u/i),c=u-h*i,l=this._evaluateAt(0,this._initialTransformCache),f=this._evaluateAt(i,this._clipEndTransformCache),p=this._evaluateAt(c,this._endTransformCache);o(a,f),Ai(Ti,l,f);for(var _=0;_<h;++_)F.multiply(n,n,Ti);o(l,p)}return n},e._evaluateAt=function(t,e){for(var n=this._trackEvalStatuses,i=n.length,r=0;r<i;++r){var a=n[r],s=a.trackEval,o=a.binding,u=s.evaluate(t,o);o.setValue(u)}return this._boneTransform.getTransform(e),e},t}();function Ai(t,e,n){F.invert(t,e),F.multiply(t,n,t)}function Si(t,e){switch(e){default:return;case"position":return{setValue:function(e){c.copy(t.position,e)}};case"rotation":return{setValue:function(e){u.copy(t.rotation,e)}};case"scale":return{setValue:function(e){c.copy(t.scale,e)}};case"eulerAngles":return{setValue:function(e){c.copy(t.eulerAngles,e)}}}}var Ei=function(){function t(t,e,n,i){this._lastFrameIndex=-1,this._lastIterations=0,this._lastDirection=0,this._ignoreIndex=-1,this._sampled=!1,this._targetNode=t,this._ratios=e,this._eventGroups=n,this._wrapMode=i}var e=t.prototype;return e.setWrapMode=function(t){this._wrapMode=t},e.ignore=function(t,e){this._ignoreIndex=-1,this._sampled=!1;var n=ki(t,this._ratios);n<0&&(n=~n-1,e<0&&(n+=1),this._ignoreIndex=n)},e.sample=function(t,e,n){var i=this._eventGroups.length,r=ki(t,this._ratios);if(r<0&&(r=~r-1,e<0&&(r+=1)),this._ignoreIndex!==r&&(this._ignoreIndex=-1),!this._sampled)return this._sampled=!0,this._doFire(r,!1),this._lastFrameIndex=r,this._lastIterations=n,void(this._lastDirection=e);var a=this._wrapMode,s=Ci(n),o=Ci(this._lastIterations),u=this._lastFrameIndex,h=this._lastDirection,c=-1!==o&&s!==o;if(u===r&&c&&1===i)this._doFire(0,!1);else if(u!==r||c){e=h;do{if(u!==r){if(-1===e&&0===u&&r>0?((a&W.PingPong)===W.PingPong?e*=-1:u=i,o++):1===e&&u===i-1&&r<i-1&&((a&W.PingPong)===W.PingPong?e*=-1:u=-1,o++),u===r)break;if(o>s)break}u+=e,this._doFire(u,!0)}while(u!==r&&u>-1&&u<i)}this._lastFrameIndex=r,this._lastIterations=n,this._lastDirection=e},e._doFire=function(t,e){e?o.director.getAnimationManager().pushDelayEvent(this._checkAndFire,this,[t]):this._checkAndFire(t)},e._checkAndFire=function(t){if(this._targetNode&&this._targetNode.isValid){var e=this._eventGroups;if(!(t<0||t>=e.length||this._ignoreIndex===t))for(var n=e[t],i=this._targetNode.components,r=n.events.length,a=0;a<r;++a)for(var s=n.events[a],o=s.functionName,u=i.length,h=0;h<u;++h){var c=i[h],l=c[o];"function"==typeof l&&l.apply(c,s.parameters)}}},t}();function Ci(t){return t-(0|t)==0&&(t-=1),0|t}function ki(t,e){return k(e,t)}var Ii,Pi=function(){function t(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var e=t.prototype;return e.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError(O(3912)):(this._isPlaying=!0,this.onPlay())},e.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},e.pause=function(){this._isPlaying&&!this._isPaused&&(this._isPaused=!0,this.onPause())},e.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},e.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.update=function(){},e.onPlay=function(){},e.onPause=function(){},e.onResume=function(){},e.onStop=function(){},e.onError=function(){},_(t,[{key:"isPlaying",get:function(){return this._isPlaying}},{key:"isPaused",get:function(){return this._isPaused}},{key:"isMotionless",get:function(){return!this.isPlaying||this.isPaused}}]),t}(),xi=function(){function t(t){this.weight=0,this._pose=void 0,this._blendStateWriters=[],this._pose=t}var e=t.prototype;return e.destroy=function(){for(var t=0;t<this._blendStateWriters.length;++t)this._pose.destroyWriter(this._blendStateWriters[t]);this._blendStateWriters.length=0},e.createPoseWriter=function(t,e,n){var i=this._pose.createWriter(t,e,this,n);return this._blendStateWriters.push(i),i},t}();!function(t){t.PLAY="play",t.STOP="stop",t.PAUSE="pause",t.RESUME="resume",t.LASTFRAME="lastframe",t.FINISHED="finished"}(Ii||(Ii={})),Q(Ii);var Oi=t("j",function(t){function e(e,n){var i;return void 0===n&&(n=""),(i=t.call(this)||this).duration=1,i.speed=1,i.time=0,i.frameRate=0,i._targetNode=null,i._curveLoaded=!1,i._clip=void 0,i._useSimpleProcess=!1,i._target=null,i._wrapMode=U.Normal,i._repeatCount=1,i._delay=0,i._delayTime=0,i._currentFramePlayed=!1,i._name=void 0,i._lastIterations=NaN,i._lastWrapInfo=null,i._wrappedInfo=new H,i._allowLastFrame=!1,i._blendStateWriterHost={weight:0},i._playbackDuration=0,i._invDuration=1,i._poseOutput=null,i._weight=0,i._clipEval=void 0,i._clipEventEval=void 0,i._doNotCreateEval=!1,i._clip=e,i._name=n||e&&e.name,i._playbackRange={min:0,max:e.duration},i._playbackDuration=e.duration,e.duration||j("Clip "+e.name+" has zero duration."),i}g(e,t);var n=e.prototype;return n.initialize=function(t){if(!this._curveLoaded){this._curveLoaded=!0,this._poseOutput&&(this._poseOutput.destroy(),this._poseOutput=null),this._clipEval&&(this._clipEval=void 0),this._targetNode=t;var e=this._clip;if(this.duration=e.duration,this._invDuration=1/this.duration,this.speed=e.speed,this.wrapMode=e.wrapMode,this.frameRate=e.sample,this._playbackRange.min=0,this._playbackRange.max=e.duration,this._playbackDuration=e.duration,(this.wrapMode&W.Loop)===W.Loop?this.repeatCount=1/0:this.repeatCount=1,!this._doNotCreateEval){var n,i,r,a=null!==(n=null===(i=o.director.getAnimationManager())||void 0===i?void 0:i.blendState)&&void 0!==n?n:null;a&&(this._poseOutput=new xi(a)),this._clipEval=e.createEvaluator({target:t,pose:null!==(r=this._poseOutput)&&void 0!==r?r:void 0})}this._clipEventEval=e.createEventEvaluator(this._targetNode)}},n.destroy=function(){this.isMotionless||o.director.getAnimationManager().removeAnimation(this),this._poseOutput&&(this._poseOutput.destroy(),this._poseOutput=null),this._clipEval=void 0},n.emit=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];o.director.getAnimationManager().pushDelayEvent(this._emit,this,e)},n.on=function(t,e,n){return this._target&&this._target.isValid?this._target.on(t,e,n):null},n.once=function(t,e,n){return this._target&&this._target.isValid?this._target.once(t,e,n):null},n.off=function(t,e,n){this._target&&this._target.isValid&&this._target.off(t,e,n)},n.allowLastFrameEvent=function(t){this._allowLastFrame=t},n._setEventTarget=function(t){this._target=t},n.setTime=function(t){this._currentFramePlayed=!1,this.time=t||0;var e,n=this.getWrappedInfo(t,this._wrappedInfo);null===(e=this._clipEventEval)||void 0===e||e.ignore(n.ratio,n.direction)},n.update=function(t){this._delayTime>0&&(this._delayTime-=t,this._delayTime>0)||(this._currentFramePlayed?this.time+=t*this.speed:this._currentFramePlayed=!0,this._process())},n.sample=function(){var t=this.getWrappedInfo(this.time,this._wrappedInfo);return this._sampleCurves(t.time),this._sampleEvents(t),t},n.onPlay=function(){this.setTime(0),this._delayTime=this._delay,this._onReplayOrResume(),this.emit(Ii.PLAY,this)},n.onStop=function(){this.isPaused||this._onPauseOrStop(),this.emit(Ii.STOP,this)},n.onResume=function(){this._onReplayOrResume(),this.emit(Ii.RESUME,this)},n.onPause=function(){this._onPauseOrStop(),this.emit(Ii.PAUSE,this)},n._sampleCurves=function(t){var e=this._poseOutput,n=this._clipEval;e&&(e.weight=this.weight),n&&n.evaluate(t)},n._process=function(){this._useSimpleProcess?this.simpleProcess():this.process()},n.process=function(){var t,e=this.sample();this._allowLastFrame&&(t=this._lastWrapInfo?this._lastWrapInfo:this._lastWrapInfo=new H(e),this.repeatCount>1&&(0|e.iterations)>(0|t.iterations)&&this.emit(Ii.LASTFRAME,this),t.set(e)),e.stopped&&(this.stop(),this.emit(Ii.FINISHED,this))},n.simpleProcess=function(){var t=this._playbackRange.min,e=this._playbackDuration,n=this.time%e;n<0&&(n+=e);var i=(t+n)*this._invDuration;this._sampleCurves(t+n),this._sampleEvents(this.getWrappedInfo(this.time,this._wrappedInfo)),this._allowLastFrame&&(Number.isNaN(this._lastIterations)&&(this._lastIterations=i),(this.time>0&&this._lastIterations>i||this.time<0&&this._lastIterations<i)&&this.emit(Ii.LASTFRAME,this),this._lastIterations=i)},n._needReverse=function(t){var e=this.wrapMode,n=!1;return(e&W.PingPong)===W.PingPong&&(t-(0|t)==0&&t>0&&(t-=1),1&t&&(n=!n)),(e&W.Reverse)===W.Reverse&&(n=!n),n},n.getWrappedInfo=function(t,e){e=e||new H;var n=this._getPlaybackStart(),i=this._getPlaybackEnd()-n,r=!1,a=this.repeatCount,s=t>0?t/i:-t/i;if(s>=a){s=a,r=!0;var o=a-(0|a);0===o&&(o=1),t=o*i*(t>0?1:-1)}if(t>i){var u=t%i;t=0===u?i:u}else t<0&&0!=(t%=i)&&(t+=i);var h=!1,c=this._wrapMode&W.ShouldWrap;c&&(h=this._needReverse(s));var l=h?-1:1;return this.speed<0&&(l*=-1),c&&h&&(t=i-t),e.time=n+t,e.ratio=e.time/this.duration,e.direction=l,e.stopped=r,e.iterations=s,e},n._getPlaybackStart=function(){return this._playbackRange.min},n._getPlaybackEnd=function(){return this._playbackRange.max},n._sampleEvents=function(t){var e;null===(e=this._clipEventEval)||void 0===e||e.sample(t.ratio,t.direction,t.iterations)},n._emit=function(t,e){this._target&&this._target.isValid&&this._target.emit(t,t,e)},n._onReplayOrResume=function(){o.director.getAnimationManager().addAnimation(this)},n._onPauseOrStop=function(){o.director.getAnimationManager().removeAnimation(this)},_(e,[{key:"clip",get:function(){return this._clip}},{key:"name",get:function(){return this._name}},{key:"length",get:function(){return this.duration}},{key:"wrapMode",get:function(){return this._wrapMode},set:function(t){var e;this._wrapMode=t,this.time=0,t&W.Loop?this.repeatCount=1/0:this.repeatCount=1,null===(e=this._clipEventEval)||void 0===e||e.setWrapMode(t)}},{key:"repeatCount",get:function(){return this._repeatCount},set:function(t){this._repeatCount=t;var e=this._wrapMode&W.ShouldWrap,n=(this.wrapMode&W.Reverse)===W.Reverse;this._useSimpleProcess=t===1/0&&!e&&!n}},{key:"delay",get:function(){return this._delay},set:function(t){this._delayTime=this._delay=t}},{key:"playbackRange",get:function(){return this._playbackRange},set:function(t){p(t.max>t.min),this._playbackRange.min=Math.max(t.min,0),this._playbackRange.max=Math.min(t.max,this.duration),this._playbackDuration=this._playbackRange.max-this._playbackRange.min,this.setTime(0)}},{key:"current",get:function(){return this.getWrappedInfo(this.time).time}},{key:"ratio",get:function(){return this.current/this.duration}},{key:"weight",get:function(){return this._weight},set:function(t){this._weight=t,this._poseOutput&&(this._poseOutput.weight=t)}},{key:"curveLoaded",get:function(){return this._curveLoaded}}]),e}(Pi));o.AnimationState=Oi;var Ni,Mi,Li,Ri,zi,Fi,Vi,Di,Ui,Bi,Wi,Qi,Hi,ji,qi,Ki,Gi,Yi=function(t){function e(e){var n;return(n=t.call(this)||this)._managedStates=[],n._fadings=[],n._scheduled=!1,n._scheduler=null!=e?e:o.director.getAnimationManager(),n}g(e,t);var n=e.prototype;return n.update=function(t){if(!this.isMotionless){var e=this._managedStates,n=this._fadings;if(1===e.length&&1===n.length){var i=e[0].state;i&&(i.weight=1)}else this._calculateWeights(t);1===e.length&&1===n.length&&this._unscheduleThis()}},n.crossFade=function(t,e){var n;0===this._managedStates.length&&(e=0),0===e&&this.clear();var i=this._managedStates.find((function(e){return e.state===t}));i?(null===(n=i.state)||void 0===n?void 0:n.isMotionless)&&i.state.play():(i={state:t,reference:0},t&&t.play(),this._managedStates.push(i)),++i.reference,this._fadings.unshift({easeDuration:e,easeTime:0,target:i}),this.isMotionless||this._scheduleThis()},n.clear=function(){for(var t=0;t<this._managedStates.length;++t){var e=this._managedStates[t].state;e&&e.stop()}this._managedStates.length=0,this._fadings.length=0},n.onPlay=function(){t.prototype.onPlay.call(this),this._scheduleThis()},n.onPause=function(){t.prototype.onPause.call(this);for(var e=0;e<this._managedStates.length;++e){var n=this._managedStates[e].state;n&&n.pause()}this._unscheduleThis()},n.onResume=function(){t.prototype.onResume.call(this);for(var e=0;e<this._managedStates.length;++e){var n=this._managedStates[e].state;n&&n.resume()}this._scheduleThis()},n.onStop=function(){t.prototype.onStop.call(this),this.clear()},n._calculateWeights=function(t){for(var e=this._managedStates,n=this._fadings,i=0;i<e.length;++i){var r=e[i].state;r&&(r.weight=0)}for(var a=1,s=n.length,o=0;o<n.length;++o){var u=n[o];u.easeTime+=t;var h=0===u.easeDuration?1:q(u.easeTime/u.easeDuration),c=h*a;if(a*=1-h,u.target.state&&(u.target.state.weight+=c),u.easeTime>=u.easeDuration){s=o+1,u.easeTime=u.easeDuration;break}}if(s!==n.length){for(var l=s;l<n.length;++l){var f=n[l];--f.target.reference,f.target.reference<=0&&(f.target.state&&f.target.state.stop(),K(this._managedStates,f.target))}n.splice(s)}},n._scheduleThis=function(){this._scheduled||(this._scheduler.addCrossFade(this),this._scheduled=!0)},n._unscheduleThis=function(){this._scheduled&&(this._scheduler.removeCrossFade(this),this._scheduled=!1)},e}(Pi);function Xi(t,e){return t===e||!!t&&!!e&&t._uuid===e._uuid&&t._uuid}t("k",(Ni=e("cc.Animation"),Mi=$(),Li=tt(99),Ri=et(),zi=G([mi]),Fi=nt(),Vi=G(mi),Di=nt(),Ui=nt(),Bi=G([mi]),Ni(Wi=Mi(Wi=Li(Wi=Y(Wi=Ri((Gi=Ki=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i))||this,a(e,"playOnLoad",Hi,y(e)),e._crossFade=new Yi,e._nameToState=X(!0),a(e,"_clips",ji,y(e)),a(e,"_defaultClip",qi,y(e)),e._hasBeenPlayed=!1,e}g(e,t);var n=e.prototype;return n.onLoad=function(){for(var t in this.clips=this._clips,this._nameToState)this._nameToState[t].initialize(this.node)},n.start=function(){this.playOnLoad&&!this._hasBeenPlayed&&this._defaultClip&&this.crossFade(this._defaultClip.name,0)},n.onEnable=function(){this._crossFade.resume()},n.onDisable=function(){this._crossFade.pause()},n.onDestroy=function(){for(var t in this._crossFade.stop(),this._nameToState)this._nameToState[t].destroy();this._nameToState=X(!0)},n.play=function(t){if(this._hasBeenPlayed=!0,!t){if(!this._defaultClip)return;t=this._defaultClip.name}this.crossFade(t,0)},n.crossFade=function(t,e){void 0===e&&(e=.3),this._hasBeenPlayed=!0;var n=this._nameToState[t];n&&(this._crossFade.play(),this._crossFade.crossFade(n,e))},n.pause=function(){this._crossFade.pause()},n.resume=function(){this._crossFade.resume()},n.stop=function(){this._crossFade.stop()},n.getAnimationState=function(t){return this.getState(t)},n.getState=function(t){var e=this._nameToState[t];return e&&!e.curveLoaded&&e.initialize(this.node),e||null},n.createState=function(t,e){return e=e||t.name,this.removeState(e),this._doCreateState(t,e)},n.removeState=function(t){var e=this._nameToState[t];e&&(e.allowLastFrameEvent(!1),e.stop(),delete this._nameToState[t])},n.addClip=function(t,e){return J(this._clips,t)||this._clips.push(t),this.createState(t,e)},n.removeClip=function(t,e){var n;for(var r in this._nameToState){var a=this._nameToState[r];if(a.clip===t){n=a;break}}if(t===this._defaultClip){if(!e)return void i(3902);this._defaultClip=null}if(n&&n.isPlaying){if(!e)return void i(3903);n.stop()}this._clips=this._clips.filter((function(e){return e!==t})),n&&delete this._nameToState[n.name]},n.on=function(e,n,i,r){var a=t.prototype.on.call(this,e,n,i,r);return e===Ii.LASTFRAME&&this._syncAllowLastFrameEvent(),a},n.once=function(e,n,i){var r=t.prototype.once.call(this,e,n,i);return e===Ii.LASTFRAME&&this._syncAllowLastFrameEvent(),r},n.off=function(e,n,i){t.prototype.off.call(this,e,n,i),e===Ii.LASTFRAME&&this._syncDisallowLastFrameEvent()},n._createState=function(t,e){return new Oi(t,e)},n._doCreateState=function(t,e){var n=this._createState(t,e);return n._setEventTarget(this),n.allowLastFrameEvent(this.hasEventListener(Ii.LASTFRAME)),this.node&&n.initialize(this.node),this._nameToState[n.name]=n,n},n._getStateByNameOrDefaultClip=function(t){if(!t){if(!this._defaultClip)return null;t=this._defaultClip.name}return this._nameToState[t]||null},n._removeStateOfAutomaticClip=function(t){for(var e in this._nameToState){var n=this._nameToState[e];Xi(t,n.clip)&&(n.stop(),delete this._nameToState[e])}},n._syncAllowLastFrameEvent=function(){if(this.hasEventListener(Ii.LASTFRAME))for(var t in this._nameToState)this._nameToState[t].allowLastFrameEvent(!0)},n._syncDisallowLastFrameEvent=function(){if(!this.hasEventListener(Ii.LASTFRAME))for(var t in this._nameToState)this._nameToState[t].allowLastFrameEvent(!1)},_(e,[{key:"clips",get:function(){return this._clips},set:function(t){var e=this;this._crossFade&&this._crossFade.clear();for(var n,i=m(this._clips);!(n=i()).done;){var r=n.value;r&&this._removeStateOfAutomaticClip(r)}for(var a,s=m(t);!(a=s()).done;){var o=a.value;o&&this.createState(o)}var u=t.find((function(t){return Xi(t,e._defaultClip)}));this._defaultClip=u||null,this._clips=t}},{key:"defaultClip",get:function(){return this._defaultClip},set:function(t){this._defaultClip=t,t&&(this._clips.findIndex((function(e){return Xi(e,t)}))>=0||(this._clips.push(t),this.createState(t)))}}]),e}(Z(it)),Ki.EventType=Ii,r((Qi=Gi).prototype,"clips",[zi,Fi],Object.getOwnPropertyDescriptor(Qi.prototype,"clips"),Qi.prototype),r(Qi.prototype,"defaultClip",[Vi,Di],Object.getOwnPropertyDescriptor(Qi.prototype,"defaultClip"),Qi.prototype),Hi=r(Qi.prototype,"playOnLoad",[s,Ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ji=r(Qi.prototype,"_clips",[Bi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qi=r(Qi.prototype,"_defaultClip",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wi=Qi))||Wi)||Wi)||Wi)||Wi)||Wi));var Ji=[],Zi=new Map,$i=new F}}}));
